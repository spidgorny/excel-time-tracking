(this["webpackJsonpexcel-time-tracking"]=this["webpackJsonpexcel-time-tracking"]||[]).push([[0],{147:function(e,t,a){e.exports=a(273)},152:function(e,t,a){},153:function(e,t,a){},232:function(e,t){},270:function(e,t,a){},273:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(26),o=a.n(i),s=(a(152),a(5)),c=a(6),l=a(9),u=a(10),d=(a(153),a(140)),h=a(145),m=a(36),f=a(44),y=a(35),p=function(){function e(){Object(s.a)(this,e),this._storage=window.localStorage,this._callbacks=[]}return Object(c.a)(e,[{key:"fetch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=this._storage.getItem(e);return a?JSON.parse(a):t}},{key:"update",value:function(e,t){this._storage.setItem(e,JSON.stringify(t))}},{key:"subscribe",value:function(e){console.log("subscribe"),this._callbacks.push(e)}},{key:"notify",value:function(){console.log("notify",this._callbacks.length);var e,t=Object(y.a)(this._callbacks);try{for(t.s();!(e=t.n()).done;){(0,e.value)()}}catch(a){t.e(a)}finally{t.f()}}}]),e}(),v=a(34),g=a(146),b=a(1),E=a.n(b),k=a(78),O=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s.a)(this,a),(e=t.call(this,n)).start=void 0,e.end=void 0,e.comment=void 0,Object.assign(Object(f.a)(e),n),e}return Object(c.a)(a,[{key:"getStartMoment",value:function(){var e=new Date,t=this.start.split(":"),a=Object(k.a)(t,2),n=a[0],r=a[1],i=parseInt(n,10),o=parseInt(r,10);return E()(e).hours(i).minutes(o)}},{key:"getEndMoment",value:function(){var e=new Date;if(!this.end){var t=new Date;return E()(e).hours(t.getHours()).minutes(t.getMinutes())}var a=this.end.split(":"),n=Object(k.a)(a,2),r=n[0],i=n[1],o=parseInt(r,10),s=parseInt(i,10);return E()(e).hours(o).minutes(s)}},{key:"finish",value:function(){this.end||(this.end=E()().format("HH:mm"))}},{key:"duration",get:function(){var e=this.getStartMoment(),t=this.getEndMoment();return E.a.duration(t.diff(e))}}]),a}(function(){function e(t){Object(s.a)(this,e),Object.assign(this,t)}return Object(c.a)(e,[{key:"assignProps",value:function(e){for(var t in e)e.hasOwnProperty(t)&&(console.log("this[",t,"] = ",e[t]),this[t]=e[t])}},{key:"toJson",value:function(){return JSON.stringify(this)}}]),e}()),j=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this)).date=void 0,n.entries=void 0,n.date=e,n.entries=n.fetch(n.key,[]).map((function(e){return new O(e)})).filter((function(e){return e.start})),n}return Object(c.a)(a,[{key:"updateEntries",value:function(e){Object(g.a)(Object(v.a)(a.prototype),"update",this).call(this,this.key,e),this.notify()}},{key:"updateOne",value:function(e){var t=this.entries.findIndex((function(t){return t===e}));-1!==t?(this.entries[t]=e,this.updateEntries(this.entries),console.log("updateOne",e),this.notify()):console.error("index in updateOne not found")}},{key:"key",get:function(){return"date."+E()(this.date).format("YYYY-MM-DD")+".entries"}},{key:"sumTime",get:function(){return this.entries.reduce((function(e,t){return t.duration.add(e)}),E.a.duration(0))}}]),a}(p),x=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;return Object(s.a)(this,a),(e=t.call(this)).date=new Date,e.rate=void 0,e.dayStateCache={},window.state=Object(f.a)(e),e.date=e.fetch("date",e.date),e.rate=e.fetch("rate",50),e}return Object(c.a)(a,[{key:"setDate",value:function(e){this.date=e,this.update("date",this.date),this.notify()}},{key:"getDay",value:function(e){var t=E()(e).format("YYYY-MM-DD");if(t in this.dayStateCache)return this.dayStateCache[t];var a=new j(e);return a.subscribe(this.notify.bind(this)),this.dayStateCache[t]=a,a}}]),a}(p),w=r.a.createContext(new x),D=a(155),N=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).context=void 0,e}return Object(c.a)(a,[{key:"render",value:function(){var e=D.byCountry(),t=navigator.language.substr(3),a=e.get(t),n=this.context.rate,i=this.props.hours*n,o=new Intl.NumberFormat(void 0,{style:"currency",currency:a}).format(i);return r.a.createElement(r.a.Fragment,null,o)}}]),a}(r.a.Component);N.contextType=w;var C=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).context=void 0,e}return Object(c.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",{onClick:function(t){return e.props.makeEditable(t,!0)}},this.startValue),r.a.createElement("td",{onClick:function(t){return e.props.makeEditable(t,!0)}},this.endValue),r.a.createElement("td",{className:"text-right"},this.duration),r.a.createElement("td",{className:"text-right"},this.earnings)),this.props.timeEntry.comment?r.a.createElement("tr",null,r.a.createElement("td",{colSpan:6},this.props.timeEntry.comment)):null)}},{key:"startValue",get:function(){return this.props.timeEntry.start?this.props.timeEntry.start:E()().format("HH:mm")}},{key:"endValue",get:function(){return this.props.timeEntry.end?this.props.timeEntry.end:""}},{key:"duration",get:function(){var e=this.props.timeEntry.duration;return e.hours().toString().padStart(2,"0")+":"+e.minutes().toString().padStart(2,"0")}},{key:"earnings",get:function(){var e=this.props.timeEntry.duration.asHours();return r.a.createElement(N,{hours:e})}}]),a}(r.a.Component);C.contextType=w;var S=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).timer=void 0,n.textInput=void 0,n.textInput=r.a.createRef(),n}return Object(c.a)(a,[{key:"keydownHandler",value:function(e){"Enter"===e.key&&e.ctrlKey&&this.props.makeEditable(e,!1)}},{key:"componentDidMount",value:function(){var e,t,a=this;this.timer=setInterval((function(){return a.forceUpdate()}),1e3),document.addEventListener("keydown",(function(e){return a.keydownHandler(e)})),null===(e=this.textInput)||void 0===e||null===(t=e.current)||void 0===t||t.focus()}},{key:"componentWillUnmount",value:function(){var e=this;clearInterval(this.timer),document.removeEventListener("keydown",(function(t){return e.keydownHandler(t)}))}},{key:"render",value:function(){return r.a.createElement("tbody",{className:"timeEntryRow"},r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("input",{type:"time",name:"start",form:"form1",value:this.startValue,onChange:this.props.onChange,className:"form-control",ref:this.textInput})),r.a.createElement("td",null,r.a.createElement("div",{className:"d-flex"},this.endValue?r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{type:"time",name:"end",form:"form1",value:this.endValue,onChange:this.props.onChange,className:"form-control"}),r.a.createElement("a",{href:"/play",className:"pl-3",onClick:this.play.bind(this)},r.a.createElement(m.a,null))):r.a.createElement(r.a.Fragment,null,r.a.createElement("output",null,this.endOutput),r.a.createElement("a",{href:"/stop",className:"pl-3",onClick:this.stop.bind(this)},r.a.createElement(m.c,null))))),r.a.createElement("td",{className:"text-right"},r.a.createElement("output",null,this.duration)),r.a.createElement("td",{className:"text-right"},r.a.createElement("output",null,this.earnings))),r.a.createElement("tr",null,r.a.createElement("td",{colSpan:6},r.a.createElement("textarea",{name:"comment",placeholder:"comment",className:"form-control",form:"form1",onChange:this.props.onChange,value:this.props.timeEntry.comment}))))}},{key:"play",value:function(e){e.preventDefault(),this.props.timeEntry.end=void 0,this.context.getDay(this.props.date).updateOne(this.props.timeEntry)}},{key:"stop",value:function(e){e.preventDefault(),this.props.timeEntry.end=E()().format("HH:mm"),this.context.getDay(this.props.date).updateOne(this.props.timeEntry)}},{key:"endOutput",get:function(){return E()().format("HH:mm:ss")}}]),a}(C),H=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).context=void 0,e.state={entries:[],editable:[]},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.fetch(),document.addEventListener("keydown",(function(t){return e.keydownHandler(t)}))}},{key:"fetch",value:function(){var e=this,t=this.context.getDay(this.props.date).entries;this.setState({entries:t},(function(){e.state.entries.length}))}},{key:"componentDidUpdate",value:function(e){e.date!==this.props.date&&this.fetch()}},{key:"keydownHandler",value:function(e){"Insert"===e.key&&this.addRow(e)}},{key:"componentWillUnmount",value:function(){var e=this;document.removeEventListener("keydown",(function(t){return e.keydownHandler(t)}))}},{key:"render",value:function(){var e=this;return r.a.createElement(h.a,null,r.a.createElement("thead",{className:"thead-light"},r.a.createElement("tr",null,r.a.createElement("th",null,"Start Time"),r.a.createElement("th",null,"End Time"),r.a.createElement("th",{className:"text-right"},"Duration"),r.a.createElement("th",{className:"text-right"},"Earnings"))),this.state.entries.map((function(t,a){return t.end&&!e.state.editable[a]?r.a.createElement(C,{date:e.props.date,timeEntry:t,key:a,onChange:function(t){return e.onChange(t,a)},makeEditable:function(t,n){return e.makeEditable(t,a,n)}}):r.a.createElement(S,{date:e.props.date,timeEntry:t,key:a,onChange:function(t){return e.onChange(t,a)},makeEditable:function(t,n){return e.makeEditable(t,a,n)}})})),this.state.entries.length?null:r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",{colSpan:4},r.a.createElement("a",{href:"/start",className:"btn btn-primary",onClick:this.startWorking.bind(this)},r.a.createElement(m.a,null))))),r.a.createElement("tfoot",{className:"tfoot-light",style:{color:"#495057",backgroundColor:"#e9ecef",borderColor:"#dee2e6"}},r.a.createElement("tr",null,r.a.createElement("td",{colSpan:1},r.a.createElement("a",{href:"/addRow",onClick:this.addRow.bind(this)},r.a.createElement(m.b,null))),r.a.createElement("td",{colSpan:1},E()(this.props.date).isSame(E()(),"day")?r.a.createElement("a",{href:"/addPlay",onClick:this.addPlay.bind(this)},r.a.createElement(m.a,null)):null),r.a.createElement("td",{className:"text-right"},this.sumTime," h"),r.a.createElement("td",{className:"text-right"},this.sumMoney))))}},{key:"startWorking",value:function(e){this.addRow(e)}},{key:"onChange",value:function(e,t){e.preventDefault();var a=e.target;if(null!==a){var n=a.closest(".timeEntryRow").querySelectorAll("input, textarea"),r=Array.from(n).map((function(e){return e.name?Object(d.a)({},e.name,e.value):{}})).reduce((function(e,t){return Object.assign(e,t)}),{}),i=this.state.entries;i[t]=new O(r),this.setState({entries:i}),this.context.getDay(this.props.date).updateEntries(this.state.entries)}}},{key:"addRow",value:function(e){var t=this;e&&e.preventDefault();var a=this.state.entries;a.length>0&&a[a.length-1].finish();a.push(new O({start:E()().subtract(1,"hour").format("HH:mm"),end:E()().format("HH:mm")}));var n=a.length-1,r=this.state.editable;r[n]=!0,this.setState({entries:a,editable:r},(function(){t.context.getDay(t.props.date).updateEntries(a)}))}},{key:"addPlay",value:function(e){var t=this;e&&e.preventDefault();var a=this.state.entries;a.length>0&&a[a.length-1].finish();a.push(new O({start:E()().format("HH:mm")})),this.setState({entries:a},(function(){t.context.getDay(t.props.date).updateEntries(a)}))}},{key:"makeEditable",value:function(e,t,a){var n=this.state.editable;n[t]=a,this.setState({editable:n})}},{key:"sumTime",get:function(){return this.context.getDay(this.props.date).sumTime.asHours().toFixed(2)}},{key:"sumMoney",get:function(){var e=this.context.getDay(this.props.date).sumTime.asHours();return r.a.createElement(N,{hours:e})}}]),a}(r.a.Component);H.contextType=w;var M=a(29),I=a(16),T=a(76),R=a(143),Y=(a(224),a(225),function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).context=void 0,e.state={focused:!1},e}return Object(c.a)(a,[{key:"isOutsideRange",value:function(e){return!!e.isAfter(E()().endOf("day"))}},{key:"isDayHighlighted",value:function(e){return this.context.getDay(e.toDate()).entries.length>0}},{key:"render",value:function(){var e=this;return r.a.createElement("header",{className:"mb-3"},r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light"},r.a.createElement("h3",{className:"navbar-brand"},r.a.createElement("a",{href:"."},"excel-time-tracking")),r.a.createElement(R.SingleDatePicker,{date:this.props.date,onDateChange:function(t){return e.setDate(t)},focused:this.state.focused,onFocusChange:function(t){return e.setState({focused:t.focused})},id:"your_unique_id",isOutsideRange:this.isOutsideRange.bind(this),isDayHighlighted:this.isDayHighlighted.bind(this),initialVisibleMonth:function(){return E()().endOf("month")}}),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse justify-content-between",id:"navbarNav"},r.a.createElement("div",null),r.a.createElement("div",{className:"navbar-nav"},r.a.createElement(T.a,{className:"nav-link active",to:"."},"Home"),r.a.createElement("a",{className:"nav-link",href:"/logout",onClick:this.logout.bind(this)},"Logout")))))}},{key:"logout",value:function(e){}},{key:"setDate",value:function(e){console.log(e),this.context.setDate(e.toDate())}}]),a}(r.a.Component));Y.contextType=w;a(270);var A=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).context=void 0,e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keydown",(function(t){return e.keydownHandler(t)}))}},{key:"keydownHandler",value:function(e){var t=(e.ctrlKey||e.metaKey)&&e.shiftKey;t&&"ArrowLeft"===e.key&&this.dayClick(e,E()(this.props.date).subtract("1","day")),t&&"ArrowRight"===e.key&&this.dayClick(e,E()(this.props.date).add("1","day"))}},{key:"componentWillUnmount",value:function(){var e=this;document.removeEventListener("keydown",(function(t){return e.keydownHandler(t)}))}},{key:"render",value:function(){for(var e=this,t=[],a=E()(this.props.date),n=-10;n<=10;n++)t.push(a.clone().add(n,"days"));return r.a.createElement("div",{className:"d-flex justify-content-center mb-3"},t.map((function(t){var a=[6,7].includes(t.isoWeekday())?"weekend":"",n=t.isSame(e.props.date,"day")?"today":"",i=r.a.createElement("div",{className:"dayBox border text-center align-baseline "+[a,n].join(" "),key:t.toISOString()},t.format("DD"));return t.isSame(e.props.date,"day")?i:r.a.createElement("a",{href:"/day/"+t.format("YYYY-MM-DD"),onClick:function(a){return e.dayClick(a,t)},style:{textDecoration:"none"},key:t.toISOString()},i)})))}},{key:"dayClick",value:function(e,t){e.preventDefault(),this.context.setDate(t.toDate())}}]),a}(r.a.Component);A.contextType=w;var W=a(59),_=a.n(W),F=a(271),L=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).context=void 0,e}return Object(c.a)(a,[{key:"render",value:function(){var e=this.hashtags;return r.a.createElement("div",{className:"card w-100 ml-2 mr-2"},r.a.createElement("div",{className:"jumbotron p-3"},r.a.createElement("h1",{className:"display-4 text-center"},this.sumTime,"h"),r.a.createElement("h3",{className:"lead text-right"},this.sumMoney)),r.a.createElement("div",{className:"card-body"},this.title),r.a.createElement("ul",{className:"list-group list-group-flush"},Object.keys(e).map((function(t){return r.a.createElement("li",{className:"list-group-item d-flex justify-content-between",key:t},t,r.a.createElement("span",{className:"badge badge-primary badge-pill"},e[t].toFixed(2),"h"))}))))}},{key:"dateRange",get:function(){for(var e=[],t=E()(this.props.date).startOf("week"),a=0;a<7;a++){var n=this.context.getDay(t.clone().add(a,"days").toDate());e.push(n)}return e}},{key:"duration",get:function(){var e,t=E.a.duration(0),a=Object(y.a)(this.dateRange);try{for(a.s();!(e=a.n()).done;){var n=e.value;t.add(n.sumTime)}}catch(r){a.e(r)}finally{a.f()}return t}},{key:"sumTime",get:function(){return this.duration.asHours().toFixed(2)}},{key:"sumMoney",get:function(){var e=this.duration.asHours();return r.a.createElement(N,{hours:e})}},{key:"hashtags",get:function(){var e,t={},a=Object(y.a)(this.dateRange);try{for(a.s();!(e=a.n()).done;){var n,r=e.value,i=Object(y.a)(r.entries);try{for(i.s();!(n=i.n()).done;){var o,s=n.value,c=F(s.comment),l=Object(y.a)(c);try{for(l.s();!(o=l.n()).done;){var u=o.value;u in t||(t[u]=0),t[u]+=s.duration.asHours()}}catch(h){l.e(h)}finally{l.f()}}}catch(h){i.e(h)}finally{i.f()}}}catch(h){a.e(h)}finally{a.f()}var d=Object.entries(t).sort((function(e,t){return t[1]-e[1]}));return Object.fromEntries(d)}},{key:"title",get:function(){return r.a.createElement("h5",null,"Week #",E()(this.props.date).isoWeek()," total")}}]),a}(r.a.Component);L.contextType=w;var V=_()(L),J=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"dateRange",get:function(){for(var e=[],t=E()(this.props.date).startOf("month"),a=0;a<t.daysInMonth();a++){var n=this.context.getDay(t.clone().add(a,"days").toDate());e.push(n)}return console.log(e.length),e}},{key:"title",get:function(){var e=E()(this.props.date);return r.a.createElement("h5",null,"Month ",e.format("YYYY-MM")," total")}}]),a}(L),P=_()(J),U=Object(I.a)(),K=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).context=void 0,e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.context.subscribe(this.forceUpdate.bind(this))}},{key:"render",value:function(){return r.a.createElement(M.a,{history:U},r.a.createElement(Y,{date:E()(this.context.date)}),r.a.createElement("main",{role:"main",className:"container-fluid"},r.a.createElement("div",{className:"h-100"},r.a.createElement(A,{date:this.context.date}),r.a.createElement(H,{date:this.context.date}),r.a.createElement("div",{className:"d-flex justify-content-between"},r.a.createElement(V,{date:this.context.date}),r.a.createElement(P,{date:this.context.date})))),r.a.createElement("footer",{className:"container-fluid"},r.a.createElement("div",{className:"inner"},"\xa9 2020 ",r.a.createElement("a",{href:"https://github.com/spidgorny/"},"Slawa"))))}}]),a}(r.a.Component);K.contextType=w;var B=K;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(B,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[147,1,2]]]);
//# sourceMappingURL=main.dabc0c5e.chunk.js.map