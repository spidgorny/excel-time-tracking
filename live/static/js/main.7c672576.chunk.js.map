{"version":3,"sources":["state/Storage.ts","model/TimeEntry.ts","model/POJO.ts","state/entries.ts","state/DayProvider.tsx","state/DateState.tsx","components/Header.tsx","state/GlobalContext.ts","page/Report.tsx","components/DayChart.tsx","components/Earnings.tsx","table/TimeEntryRow.tsx","table/TimeEntryEdit.tsx","table/DayTable.tsx","functions.ts","components/delayed.tsx","stats/extract-week-data.tsx","stats/WeekTotal.tsx","stats/MonthTotal.tsx","table/clipboard-handler.tsx","page/main-page.tsx","router-switch.tsx","components/key-nav.tsx","components/DayTimeline.tsx","page/layout.tsx","table/handle-save.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["Storage","_storage","window","localStorage","_callbacks","name","defaultValue","val","this","getItem","JSON","parse","value","setItem","stringify","call","comment","index","push","console","log","TimeEntry","props","start","end","Object","assign","date","Date","split","hr","min","iHr","parseInt","iMin","moment","hours","minutes","now","getHours","getMinutes","format","join","getStartMoment","getEndMoment","duration","diff","key","hasOwnProperty","Entries","storage","time","entries","fetch","map","el","filter","timeEnd","state","update","setState","timeEntry","timeEntries","findIndex","updateEntries","error","splice","e","hash","children","reduce","acc","te","add","React","Component","DayProvider","rate","data","warn","toISOString","dayData","DateState","setDate","toDate","subtract","Fragment","bind","toString","HeaderClass","context","focused","isAfter","endOf","day","length","className","Navbar","Brand","href","onDateChange","onFocusChange","x","id","isOutsideRange","isDayHighlighted","initialVisibleMonth","type","data-toggle","data-target","aria-controls","aria-expanded","aria-label","Collapse","location","pathname","to","Header","withRouter","GlobalContext","createContext","undefined","Report","daysInMonth","days","Array","from","i","startOf","dayRepo","getDay","sumTime","asHours","toFixed","Table","as","entry","DayChart","style","position","height","border","top","left","width","borderRight","color","flex","textAlign","workEntries","mmtMidnight","clone","offset","background","opacity","currencies","require","Earnings","byCountry","countryCode","navigator","language","substr","currency","get","amount","result","Intl","NumberFormat","onClick","askPrice","price","prompt","iPrice","parseFloat","setRate","contextType","TimeEntryRow","Row","Col","makeEditable","startValue","endValue","earnings","dur","padStart","TimeEntryEdit","timer","formRef","textInput","createRef","keydownHandler","ctrlKey","preventDefault","submit","remove","document","addEventListener","current","focus","removeEventListener","onChange","Form","ref","onSubmit","form","play","endOutput","stop","placeholder","updateOne","startTimer","setInterval","forceUpdate","stopTimer","clearInterval","DayTable","editable","prevProps","addRow","Container","fluid","backgroundColor","borderColor","yesNo","sumHours","sumMoney","values","eElements","pair","inputElementsToMap","querySelectorAll","finish","hh","mm","Delayed","waitBeforeShow","useState","isShown","setIsShown","useEffect","setTimeout","ExtractWeekData1","monday","dayProvider","dateRange","dayState","ExtractWeekData","memo","a","b","findHashtags","WeekTotalComponent","hashtags","title","keys","tag","Math","random","sum","tagTimes","tags","sorted","sort","fromEntries","paddingTop","isoWeek","PureComponent","WeekTotal","MonthTotalComponent","month","MonthTotal","ClipboardHandler","clipboard","setClipboard","escFunction","useCallback","event","toLowerCase","slice","MainPage","appState","gap","RouterSwitch","exact","path","Provider","KeyNav","decDate","incDate","DayTimeline","myInput","ctrl","metaKey","shiftKey","dayClick","offsetWidth","handleResize","today","range","isWeekend","includes","isoWeekday","isToday","isSame","dayBox","textDecoration","round","Layout","role","dateState","HandleSave","onKeyDown","year","yearDates","isBefore","exportObj","exportName","dataStr","encodeURIComponent","downloadAnchorNode","createElement","setAttribute","body","appendChild","click","downloadObjectAsJson","signature","history","createBrowserHistory","App","Boolean","hostname","match","ReactDOM","render","StrictMode","getElementById","serviceWorker","ready","then","registration","unregister","catch","message"],"mappings":"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","file":"static/js/main.7c672576.chunk.js","sourcesContent":["export class Storage {\n\t_storage = window.localStorage;\n\n\t_callbacks: Function[] = [];\n\n\tfetch(name: string, defaultValue: any = null) {\n\t\tconst val = this._storage.getItem(name);\n\t\tif (!val) {\n\t\t\treturn defaultValue;\n\t\t}\n\t\treturn JSON.parse(val);\n\t}\n\n\tupdate(name: string, value: any) {\n\t\tthis._storage.setItem(name, JSON.stringify(value));\n\t}\n\n\tsubscribe(call: Function, comment?: string) {\n\t\tlet index = this._callbacks.push(call) - 1;\n\t\tconsole.log('subscribe', index, call.name, comment);\n\t\treturn index;\n\t}\n\n\tunsubscribe(index: number, comment?: string) {\n\t\tconsole.log('unsubscribe', index, comment);\n\t\tdelete this._callbacks[index];\n\t}\n\n\tnotify() {\n\t\t// console.log(\"notify\", this._callbacks.length);\n\t\t// for (const callMe of this._callbacks) {\n\t\t// console.time(callMe.name);\n\t\t// callMe && callMe();\n\t\t// console.timeEnd(callMe.name);\n\t\t// }\n\t}\n}\n","import { POJO } from \"./POJO\";\nimport moment from \"moment\";\n\nexport class TimeEntry extends POJO {\n  // @ts-ignore\n  start: string;\n  end: string | undefined;\n  comment: string | undefined;\n\n  constructor(props: any = {}) {\n    super(props);\n    Object.assign(this, props);\n  }\n\n  get duration() {\n    const start = this.getStartMoment();\n    const end = this.getEndMoment();\n    const dur = moment.duration(end.diff(start));\n    return dur;\n  }\n\n  getStartMoment() {\n    const date = new Date();\n    const [hr, min] = this.start.split(\":\");\n    const iHr = parseInt(hr, 10);\n    const iMin = parseInt(min, 10);\n    const from = moment(date).hours(iHr).minutes(iMin);\n    return from;\n  }\n\n  // returns now() if no end time specified\n  getEndMoment() {\n    const date = new Date();\n    if (!this.end) {\n      const now = new Date();\n      return moment(date).hours(now.getHours()).minutes(now.getMinutes());\n    }\n    const [hr, min] = this.end.split(\":\");\n    const iHr = parseInt(hr, 10);\n    const iMin = parseInt(min, 10);\n    const till = moment(date).hours(iHr).minutes(iMin);\n    return till;\n  }\n\n  finish() {\n    if (!this.end) {\n      this.end = moment().format(\"HH:mm\");\n    }\n  }\n\n  hash() {\n    return [this.start, this.end, this.comment].join(\".\");\n  }\n}\n","export class POJO {\n  // [key: string]: any;\n\n  constructor(props: any) {\n    Object.assign(this, props);\n  }\n\n  assignProps(props: any) {\n    for (const key in props) {\n      if (props.hasOwnProperty(key)) {\n        console.log(\"this[\", key, \"] = \", props[key]);\n        // @ts-ignore\n        this[key] = props[key];\n      }\n    }\n  }\n\n  toJson() {\n    return JSON.stringify(this);\n  }\n}\n","import { Storage } from './Storage';\nimport moment from 'moment';\nimport { TimeEntry } from '../model/TimeEntry';\nimport React from 'react';\n\ninterface Props {\n\tdate: Date;\n\tchildren: (dayData: Entries) => JSX.Element;\n}\n\ninterface State {\n\tentries: TimeEntry[];\n}\n\nexport class Entries extends React.Component<Props, State> {\n\tstorage: Storage;\n\n\tconstructor(props: Props) {\n\t\tsuper(props);\n\t\tthis.storage = new Storage();\n\t\tconsole.time('DaysState ' + this.key);\n\t\tconst entries = this.storage\n\t\t\t.fetch(this.key, [])\n\t\t\t.map((el: any) => new TimeEntry(el))\n\t\t\t.filter((el: TimeEntry) => el.start);\n\t\tconsole.timeEnd('DaysState ' + this.key);\n\t\t// @ts-ignore\n\t\t// noinspection JSConstantReassignment\n\t\tthis.state = {\n\t\t\tentries,\n\t\t};\n\t}\n\n\tget key() {\n\t\tconst ymd = moment(this.props.date).format('YYYY-MM-DD');\n\t\treturn 'date.' + ymd + '.entries';\n\t}\n\n\tget sumTime(): moment.Duration {\n\t\tconst sum = this.state.entries.reduce(\n\t\t\t(acc: moment.Duration, te: TimeEntry) => te.duration.add(acc),\n\t\t\tmoment.duration(0),\n\t\t);\n\t\treturn sum;\n\t}\n\n\tupdateEntries(entries: TimeEntry[]) {\n\t\tconsole.time('DayState WRITE ' + this.key);\n\t\tthis.storage.update(this.key, entries);\n\t\tconsole.timeEnd('DayState WRITE ' + this.key);\n\t\tthis.setState({\n\t\t\tentries,\n\t\t});\n\t}\n\n\tupdateOne(timeEntry: TimeEntry) {\n\t\tlet timeEntries = this.state.entries;\n\t\tconst index = timeEntries.findIndex((el) => el === timeEntry);\n\t\tif (index === -1) {\n\t\t\tconsole.error('index in updateOne not found');\n\t\t\treturn;\n\t\t}\n\t\ttimeEntries[index] = timeEntry;\n\t\tthis.updateEntries(timeEntries);\n\t}\n\n\tremove(index: number) {\n\t\tthis.state.entries.splice(index, 1);\n\t\tthis.storage.update(this.key, this.state.entries);\n\t\tthis.setState({\n\t\t\tentries: this.state.entries,\n\t\t});\n\t}\n\n\thash() {\n\t\treturn [\n\t\t\tthis.props.date,\n\t\t\t...this.state.entries.map((e) => e.hash()),\n\t\t].join('.');\n\t}\n\n\trender() {\n\t\treturn this.props.children(this);\n\t}\n}\n","import { Storage } from './Storage';\nimport { Entries } from './entries';\nimport React from 'react';\nimport moment from 'moment';\n\ninterface Props {\n\tdate: Date;\n\tchildren: (day: Entries, dayProvider: DayProvider) => JSX.Element;\n}\n\ninterface State {\n\trate: number;\n}\n\nexport class DayProvider extends React.Component<Props, State> {\n\tstorage: Storage;\n\n\t// @ts-ignore\n\tstate: State = {};\n\n\tconstructor(props: any) {\n\t\tsuper(props);\n\t\tthis.storage = new Storage();\n\t\tthis.state.rate = this.storage.fetch('rate', 50);\n\t}\n\n\tsetRate(rate: number) {\n\t\tthis.setState({\n\t\t\trate,\n\t\t});\n\t}\n\n\t/// read-only for reports, changes will not be saved\n\tgetDay(date: Date) {\n\t\tconst ds = new Entries({\n\t\t\tdate,\n\t\t\tchildren: (data: Entries) => {\n\t\t\t\treturn <></>;\n\t\t\t},\n\t\t});\n\t\treturn ds;\n\t}\n\n\trender() {\n\t\tconsole.warn('DayProvider', moment(this.props.date).toISOString());\n\t\treturn (\n\t\t\t<Entries date={this.props.date}>\n\t\t\t\t{(dayData: Entries) => {\n\t\t\t\t\tconsole.log(dayData.state.entries);\n\t\t\t\t\treturn this.props.children(dayData, this);\n\t\t\t\t}}\n\t\t\t</Entries>\n\t\t);\n\t}\n}\n","import React, { PropsWithChildren } from 'react';\nimport moment from 'moment';\nimport { Storage } from './Storage';\n\ninterface State {\n\tdate: Date;\n}\n\nexport type SetDate = (date: Date) => void;\n\ninterface Props {\n\tchildren: (\n\t\tdate: Date,\n\t\tsetDate: SetDate,\n\t\tdateState: DateState,\n\t) => JSX.Element;\n}\n\nexport class DateState extends React.Component<\n\tPropsWithChildren<Props>,\n\tState\n> {\n\tstorage: Storage;\n\n\tstate: State = {\n\t\tdate: new Date(),\n\t};\n\n\tconstructor(props: any) {\n\t\tsuper(props);\n\t\tthis.storage = new Storage();\n\t\tthis.state.date = this.storage.fetch('date', this.state.date);\n\t}\n\n\tsetDate(date: Date) {\n\t\tconsole.log('setDate', moment(date).toISOString());\n\t\tthis.storage.update('date', date);\n\t\tthis.setState({\n\t\t\tdate,\n\t\t});\n\t}\n\n\tincDate() {\n\t\tthis.setDate(moment(this.state.date).add(1, 'day').toDate());\n\t}\n\n\tdecDate() {\n\t\tthis.setDate(moment(this.state.date).subtract(1, 'day').toDate());\n\t}\n\n\trender() {\n\t\tconsole.log('DateState render', moment(this.state.date).toISOString());\n\t\treturn (\n\t\t\t<React.Fragment key={this.state.date.toString()}>\n\t\t\t\t{this.props.children(\n\t\t\t\t\tthis.state.date,\n\t\t\t\t\tthis.setDate.bind(this),\n\t\t\t\t\tthis,\n\t\t\t\t)}\n\t\t\t</React.Fragment>\n\t\t);\n\t}\n}\n","import React from 'react';\nimport { Link, withRouter } from 'react-router-dom';\n// @ts-ignore\nimport { SingleDatePicker } from 'react-dates';\nimport 'react-dates/lib/css/_datepicker.css';\nimport 'react-dates/initialize';\nimport moment from 'moment';\nimport { Entries } from '../state/entries';\nimport Navbar from 'react-bootstrap/Navbar';\nimport { RouteComponentProps } from 'react-router';\n\ninterface IHeaderProps extends RouteComponentProps {\n\tdate: moment.Moment;\n\tday: Entries;\n\tsetDate: (date: Date) => void;\n}\n\nclass HeaderClass extends React.Component<\n\tIHeaderProps,\n\t{\n\t\tfocused: boolean;\n\t}\n> {\n\t// static contextType = GlobalContext;\n\t// @ts-ignore\n\t// context: AppState;\n\tcontext: undefined;\n\n\tstate = {\n\t\tfocused: false,\n\t};\n\n\tisOutsideRange(date: moment.Moment) {\n\t\tif (date.isAfter(moment().endOf('day'))) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tisDayHighlighted(date: moment.Moment) {\n\t\t// const dayState = this.context.getDay(date.toDate());\n\t\tconst dayState = this.props.day;\n\t\treturn dayState.state.entries.length > 0;\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<header className=\"mb-3\">\n\t\t\t\t<Navbar className=\"navbar navbar-expand-lg navbar-light bg-light\">\n\t\t\t\t\t<Navbar.Brand className=\"navbar-brand\">\n\t\t\t\t\t\t<a href=\".\">excel-time-tracking</a>\n\t\t\t\t\t</Navbar.Brand>\n\t\t\t\t\t<SingleDatePicker\n\t\t\t\t\t\tdate={this.props.date} // momentPropTypes.momentObj or null\n\t\t\t\t\t\tonDateChange={(date: moment.Moment) =>\n\t\t\t\t\t\t\tthis.setDate(date)\n\t\t\t\t\t\t} // PropTypes.func.isRequired\n\t\t\t\t\t\tfocused={this.state.focused} // PropTypes.bool\n\t\t\t\t\t\tonFocusChange={(x: any) =>\n\t\t\t\t\t\t\tthis.setState({ focused: x.focused })\n\t\t\t\t\t\t} // PropTypes.func.isRequired\n\t\t\t\t\t\tid=\"your_unique_id\" // PropTypes.string.isRequired,\n\t\t\t\t\t\tisOutsideRange={this.isOutsideRange.bind(this)}\n\t\t\t\t\t\tisDayHighlighted={this.isDayHighlighted.bind(this)}\n\t\t\t\t\t\tinitialVisibleMonth={() => moment().endOf('month')}\n\t\t\t\t\t/>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclassName=\"navbar-toggler\"\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\tdata-toggle=\"collapse\"\n\t\t\t\t\t\tdata-target=\"#navbarNav\"\n\t\t\t\t\t\taria-controls=\"navbarNav\"\n\t\t\t\t\t\taria-expanded=\"false\"\n\t\t\t\t\t\taria-label=\"Toggle navigation\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span className=\"navbar-toggler-icon\" />\n\t\t\t\t\t</button>\n\n\t\t\t\t\t<Navbar.Collapse\n\t\t\t\t\t\tclassName=\"collapse navbar-collapse justify-content-between\"\n\t\t\t\t\t\tid=\"navbarNav\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div />\n\t\t\t\t\t\t<div className=\"navbar-nav\">\n\t\t\t\t\t\t\t<Link\n\t\t\t\t\t\t\t\tclassName={[\n\t\t\t\t\t\t\t\t\t'nav-link',\n\t\t\t\t\t\t\t\t\tthis.props.location.pathname === '/'\n\t\t\t\t\t\t\t\t\t\t? 'active'\n\t\t\t\t\t\t\t\t\t\t: '',\n\t\t\t\t\t\t\t\t].join(' ')}\n\t\t\t\t\t\t\t\tto=\"/\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tHome\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t<Link\n\t\t\t\t\t\t\t\tclassName={[\n\t\t\t\t\t\t\t\t\t'nav-link',\n\t\t\t\t\t\t\t\t\tthis.props.location.pathname === '/report'\n\t\t\t\t\t\t\t\t\t\t? 'active'\n\t\t\t\t\t\t\t\t\t\t: '',\n\t\t\t\t\t\t\t\t].join(' ')}\n\t\t\t\t\t\t\t\tto=\"/report\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tReport\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Navbar.Collapse>\n\t\t\t\t</Navbar>\n\t\t\t</header>\n\t\t);\n\t}\n\n\tlogout(e: React.MouseEvent) {}\n\n\tsetDate(date: moment.Moment) {\n\t\tconsole.log(date);\n\t\t// this.context.setDate(date.toDate());\n\t\tthis.props.setDate(date.toDate());\n\t}\n}\n\nexport var Header = withRouter(HeaderClass);\n","import React from 'react';\nimport { DayProvider } from './DayProvider';\n\nexport var GlobalContext = React.createContext(\n\t(undefined as unknown) as DayProvider,\n);\n","import React from 'react';\nimport moment from 'moment';\nimport Table from 'react-bootstrap/Table';\nimport { Entries } from '../state/entries';\n\ninterface IReportProps {\n\tdate: Date;\n\tgetDay: (date: Date) => Entries;\n}\n\ninterface IReportState {}\n\nexport class Report extends React.Component<IReportProps, IReportState> {\n\t// static contextType = GlobalContext;\n\t// @ts-ignore\n\t// context: AppState;\n\tcontext: undefined;\n\n\tstate: IReportState = {};\n\n\trender() {\n\t\tlet daysInMonth = moment(this.props.date).daysInMonth();\n\t\tconst days = Array.from(new Array(daysInMonth), (x, i) => i + 1);\n\t\t//console.log(days);\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t{days.map((day) => {\n\t\t\t\t\tconst date = moment(this.props.date)\n\t\t\t\t\t\t.startOf('month')\n\t\t\t\t\t\t.date(day);\n\t\t\t\t\tlet dayRepo = this.props.getDay(date.toDate());\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<h3 key={day}>\n\t\t\t\t\t\t\t\t{date.format('YYYY-MM-DD')}\n\t\t\t\t\t\t\t\t{dayRepo.sumTime.asHours() === 0\n\t\t\t\t\t\t\t\t\t? null\n\t\t\t\t\t\t\t\t\t: ': ' +\n\t\t\t\t\t\t\t\t\t  dayRepo.sumTime.asHours().toFixed(2) +\n\t\t\t\t\t\t\t\t\t  ' h'}\n\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t\t<Table as=\"table\">\n\t\t\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t\t\t{dayRepo.state.entries.map((entry) => {\n\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td>{entry.start}</td>\n\t\t\t\t\t\t\t\t\t\t\t\t<td>{entry.end}</td>\n\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{entry.duration\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.asHours()\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.toFixed(2)}{' '}\n\t\t\t\t\t\t\t\t\t\t\t\t\th\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t<td>{entry.comment}</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t</tbody>\n\t\t\t\t\t\t\t</Table>\n\t\t\t\t\t\t</>\n\t\t\t\t\t);\n\t\t\t\t})}\n\t\t\t</div>\n\t\t);\n\t}\n}\n","import React from 'react';\nimport { TimeEntry } from '../model/TimeEntry';\nimport './DayTimeline.scss';\n\ninterface IDayTimelineProps {\n\tworkEntries: TimeEntry[];\n}\n\ninterface IDayTimelineState {}\n\nexport class DayChart extends React.Component<\n\tIDayTimelineProps,\n\tIDayTimelineState\n> {\n\t// static contextType = GlobalContext;\n\t// @ts-ignore\n\t// context: AppState;\n\tcontext: undefined;\n\n\tstate: IDayTimelineState = {};\n\n\trender() {\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName=\"mb-3\"\n\t\t\t\tstyle={{\n\t\t\t\t\tposition: 'relative',\n\t\t\t\t\theight: '1.55em',\n\t\t\t\t\tborder: 'solid 1px silver',\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\tleft: 0,\n\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<div className=\"d-flex justify-content-between\">\n\t\t\t\t\t\t{Array.from(new Array(24), (x, i) => i).map((hr) => {\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tkey={hr}\n\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\tborderRight: 'solid 1px silver',\n\t\t\t\t\t\t\t\t\t\tcolor: 'silver',\n\t\t\t\t\t\t\t\t\t\tflex: '1 1 0px',\n\t\t\t\t\t\t\t\t\t\theight: '1.5em',\n\t\t\t\t\t\t\t\t\t\ttextAlign: 'center',\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{hr % 2 === 0 ? hr : null}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\tleft: 0,\n\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{this.props.workEntries.map((entry) => {\n\t\t\t\t\t\tconst start = entry.getStartMoment();\n\t\t\t\t\t\tconst end = entry.getEndMoment();\n\t\t\t\t\t\tconst duration = end.diff(start, 'minutes');\n\t\t\t\t\t\tconst width = (duration / 24 / 60) * 100;\n\n\t\t\t\t\t\tconst mmtMidnight = start.clone().startOf('day');\n\t\t\t\t\t\tconst offset =\n\t\t\t\t\t\t\t(start.diff(mmtMidnight, 'minutes') / 24 / 60) *\n\t\t\t\t\t\t\t100;\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tkey={entry.start}\n\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\tbackground: '#009ACD',\n\t\t\t\t\t\t\t\t\theight: '1.5em',\n\t\t\t\t\t\t\t\t\twidth: width + '%',\n\t\t\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t\t\tleft: offset + '%',\n\t\t\t\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\t\t\t\topacity: 0.5,\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n","import React from 'react';\nimport { DayProvider } from '../state/DayProvider';\nimport { GlobalContext } from '../state/GlobalContext';\n\nconst currencies = require('country-currency');\n\ninterface Props {\n\trate: number;\n\thours: number;\n}\n\nexport class Earnings extends React.Component<Props, {}> {\n\tstatic contextType = GlobalContext;\n\t// @ts-ignore\n\tcontext: DayProvider;\n\n\trender() {\n\t\tconst byCountry = currencies.byCountry();\n\t\tlet countryCode = navigator.language.substr(3);\n\t\tconst currency = byCountry.get(countryCode);\n\t\t// console.log(countryCode, currency);\n\t\tconst rate = this.props.rate;\n\n\t\tconst amount = this.props.hours * rate;\n\t\tconst result = new Intl.NumberFormat(undefined, {\n\t\t\tstyle: 'currency',\n\t\t\tcurrency,\n\t\t}).format(amount);\n\t\treturn <span onClick={this.askPrice.bind(this)}>{result}</span>;\n\t}\n\n\taskPrice() {\n\t\tconst price = prompt('Price per Hour?');\n\t\tif (!price) {\n\t\t\treturn;\n\t\t}\n\t\tconst iPrice = parseFloat(price);\n\t\tif (!iPrice) {\n\t\t\treturn;\n\t\t}\n\t\tthis.context.setRate(iPrice);\n\t}\n}\n","import React from 'react';\nimport { TimeEntry } from '../model/TimeEntry';\nimport moment from 'moment';\nimport { Earnings } from '../components/Earnings';\nimport { Col, Row } from 'react-bootstrap';\nimport { Entries } from '../state/entries';\n\nexport interface ITimeEntryRowProps {\n\tdate: Date;\n\tday: Entries;\n\ttimeEntry: TimeEntry;\n\tonChange: (e: HTMLFormElement) => void;\n\tmakeEditable: (yesOrNo: boolean) => void;\n\tremove: () => void;\n}\n\nexport class TimeEntryRow extends React.Component<ITimeEntryRowProps> {\n\t// static contextType = GlobalContext;\n\t// @ts-ignore\n\t// context: AppState;\n\tcontext: undefined;\n\n\tget startValue() {\n\t\tif (this.props.timeEntry.start) {\n\t\t\treturn this.props.timeEntry.start;\n\t\t}\n\t\treturn moment().format('HH:mm');\n\t}\n\n\tget endValue() {\n\t\tif (this.props.timeEntry.end) {\n\t\t\treturn this.props.timeEntry.end;\n\t\t}\n\t\treturn '';\n\t}\n\n\tget duration() {\n\t\tconst dur = this.props.timeEntry.duration;\n\t\treturn (\n\t\t\tdur.hours().toString().padStart(2, '0') +\n\t\t\t':' +\n\t\t\tdur.minutes().toString().padStart(2, '0')\n\t\t);\n\t}\n\n\tget earnings() {\n\t\tconst hours = this.props.timeEntry.duration.asHours();\n\t\t// TODO: rate\n\t\treturn <Earnings hours={hours} rate={50} />;\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<Row>\n\t\t\t\t\t<Col onClick={() => this.props.makeEditable(true)}>\n\t\t\t\t\t\t{this.startValue}\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col\n\t\t\t\t\t\tclassName=\"text-right\"\n\t\t\t\t\t\tonClick={() => this.props.makeEditable(true)}\n\t\t\t\t\t>\n\t\t\t\t\t\t{this.endValue}\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col className=\"text-right\">{this.duration}</Col>\n\t\t\t\t\t<Col className=\"text-right\">{this.earnings}</Col>\n\t\t\t\t\t<Col onClick={() => this.props.makeEditable(true)}>\n\t\t\t\t\t\t{this.props.timeEntry.comment}\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\t\t\t</>\n\t\t);\n\t}\n}\n","import React, { FormEvent } from 'react';\nimport moment from 'moment';\nimport { ITimeEntryRowProps, TimeEntryRow } from './TimeEntryRow';\nimport { FaPlay, FaStop } from 'react-icons/fa';\nimport { Col, Form, Row } from 'react-bootstrap';\n\n// interface ITimeEntryRowProps {\n// \tdate: Date;\n// \ttimeEntry: TimeEntry;\n// \tonChange: (e: React.ChangeEvent) => void;\n// \tmakeEditable: (e: Event, yesOrNo: boolean) => void;\n// }\n\nexport class TimeEntryEdit extends TimeEntryRow {\n\ttimer: any;\n\tformRef: React.RefObject<HTMLFormElement>;\n\ttextInput: React.RefObject<HTMLInputElement>;\n\n\tconstructor(props: ITimeEntryRowProps) {\n\t\tsuper(props);\n\t\tconsole.log('TimeEntryEdit.constructor');\n\t\tthis.formRef = React.createRef();\n\t\tthis.textInput = React.createRef();\n\t\t// for removeEventListener\n\t\tthis.keydownHandler = this.keydownHandler.bind(this);\n\t}\n\n\tget endOutput() {\n\t\treturn moment().format('HH:mm:ss');\n\t}\n\n\tkeydownHandler(e: KeyboardEvent) {\n\t\t// console.log(e.key, e.ctrlKey, e.metaKey);\n\t\tif (e.key === 'Enter' && e.ctrlKey) {\n\t\t\te.preventDefault();\n\t\t\tthis.submit();\n\t\t}\n\t\tif (e.key === 'Backspace' && e.ctrlKey) {\n\t\t\te.preventDefault();\n\t\t\tconsole.log(e.key);\n\t\t\tthis.props.remove();\n\t\t}\n\t}\n\n\tcomponentDidMount(): void {\n\t\tconsole.log('addEventListener');\n\t\tdocument.addEventListener('keydown', this.keydownHandler);\n\t\tthis.textInput?.current?.focus();\n\t}\n\n\tcomponentWillUnmount(): void {\n\t\tconsole.log('removeEventListener');\n\t\tdocument.removeEventListener('keydown', this.keydownHandler);\n\t}\n\n\tsubmit(e?: FormEvent) {\n\t\te && e.preventDefault();\n\t\tconsole.log('formRef', this.formRef.current);\n\t\tthis.formRef.current && this.props.onChange(this.formRef.current);\n\t\tthis.props.makeEditable(false);\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<Form ref={this.formRef} onSubmit={this.submit.bind(this)}>\n\t\t\t\t<Row className=\"timeEntryRow\">\n\t\t\t\t\t<Col>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"time\"\n\t\t\t\t\t\t\tname=\"start\"\n\t\t\t\t\t\t\tform=\"form1\"\n\t\t\t\t\t\t\tdefaultValue={this.startValue}\n\t\t\t\t\t\t\t// onChange={this.props.onChange}\n\t\t\t\t\t\t\tclassName=\"form-control\"\n\t\t\t\t\t\t\tref={this.textInput}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col>\n\t\t\t\t\t\t<div className=\"d-flex\">\n\t\t\t\t\t\t\t{this.endValue ? (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\ttype=\"time\"\n\t\t\t\t\t\t\t\t\t\tname=\"end\"\n\t\t\t\t\t\t\t\t\t\tform=\"form1\"\n\t\t\t\t\t\t\t\t\t\tdefaultValue={this.endValue}\n\t\t\t\t\t\t\t\t\t\t// onChange={this.props.onChange}\n\t\t\t\t\t\t\t\t\t\tclassName=\"form-control\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\thref=\"/play\"\n\t\t\t\t\t\t\t\t\t\tclassName=\"pl-3\"\n\t\t\t\t\t\t\t\t\t\tonClick={this.play.bind(this)}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<FaPlay />\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<output>{this.endOutput}</output>\n\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\thref=\"/stop\"\n\t\t\t\t\t\t\t\t\t\tclassName=\"pl-3\"\n\t\t\t\t\t\t\t\t\t\tonClick={this.stop.bind(this)}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<FaStop />\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col className=\"text-right\">\n\t\t\t\t\t\t<output>{this.duration}</output>\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col className=\"text-right\">\n\t\t\t\t\t\t<output>{this.earnings}</output>\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col>\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tname=\"comment\"\n\t\t\t\t\t\t\tplaceholder=\"comment\"\n\t\t\t\t\t\t\tclassName=\"form-control\"\n\t\t\t\t\t\t\tform=\"form1\"\n\t\t\t\t\t\t\t// onChange={this.props.onChange}\n\t\t\t\t\t\t\tdefaultValue={this.props.timeEntry.comment}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\t\t\t</Form>\n\t\t);\n\t}\n\n\tplay(e: React.MouseEvent) {\n\t\te.preventDefault();\n\t\tthis.props.timeEntry.end = undefined;\n\t\t// const dayStorage = this.context.getDay(this.props.date);\n\t\tconst dayStorage = this.props.day;\n\t\tdayStorage.updateOne(this.props.timeEntry);\n\t\tthis.startTimer();\n\t}\n\n\tstartTimer() {\n\t\tthis.timer = setInterval(() => this.forceUpdate(), 1000);\n\t}\n\n\tstop(e: React.MouseEvent) {\n\t\te.preventDefault();\n\t\tthis.props.timeEntry.end = moment().format('HH:mm');\n\t\t// const dayStorage = this.context.getDay(this.props.date);\n\t\tconst dayStorage = this.props.day;\n\t\tdayStorage.updateOne(this.props.timeEntry);\n\t\tthis.stopTimer();\n\t\tthis.props.makeEditable(false);\n\t}\n\n\tstopTimer() {\n\t\tthis.timer && clearInterval(this.timer);\n\t}\n}\n","import React from 'react';\nimport { FaPlus } from 'react-icons/fa';\nimport { DayProvider } from '../state/DayProvider';\nimport { TimeEntry } from '../model/TimeEntry';\nimport { TimeEntryRow } from './TimeEntryRow';\nimport moment from 'moment';\nimport { TimeEntryEdit } from './TimeEntryEdit';\nimport { Earnings } from '../components/Earnings';\nimport { Col, Container, Row } from 'react-bootstrap';\nimport { Entries } from '../state/entries';\nimport { inputElementsToMap } from '../functions';\n\ninterface Props {\n\tdate: Date;\n\tday: Entries;\n\tappState: DayProvider; // for subscribe/unsubscribe\n}\n\ninterface IDayTableState {\n\tentries: TimeEntry[];\n\teditable: boolean[];\n}\n\nexport class DayTable extends React.Component<Props, IDayTableState> {\n\t// static contextType = GlobalContext;\n\t// @ts-ignore\n\t// context: AppState;\n\tcontext: undefined;\n\n\tstate = {\n\t\tentries: [],\n\t\teditable: [],\n\t};\n\n\tget sumHours() {\n\t\t// const dayState = this.context.getDay(this.props.date);\n\t\tconst dayState = this.props.day;\n\t\treturn dayState.sumTime.asHours().toFixed(2);\n\t}\n\n\tget sumTime() {\n\t\t// const dayState = this.context.getDay(this.props.date);\n\t\tconst dayState = this.props.day;\n\t\tconst duration = dayState.sumTime;\n\t\tlet hh = duration.get('hours');\n\t\tlet mm = duration.get('minutes');\n\t\treturn (\n\t\t\thh.toString().padStart(2, '0') +\n\t\t\t':' +\n\t\t\tmm.toString().padStart(2, '0')\n\t\t);\n\t}\n\n\tget sumMoney() {\n\t\t// const dayState = this.context.getDay(this.props.date);\n\t\tconst dayState = this.props.day;\n\t\tconst hours = dayState.sumTime.asHours();\n\t\t// TODO: rate\n\t\treturn <Earnings hours={hours} rate={50} />;\n\t}\n\n\tcomponentDidMount(): void {\n\t\tthis.fetch();\n\t\tdocument.addEventListener('keydown', (e) => this.keydownHandler(e));\n\t}\n\n\tcomponentWillUnmount(): void {\n\t\tdocument.removeEventListener('keydown', (e) => this.keydownHandler(e));\n\t}\n\n\tcomponentDidUpdate(prevProps: any) {\n\t\tif (prevProps.date !== this.props.date) {\n\t\t\tthis.fetch();\n\t\t}\n\t}\n\n\tfetch() {\n\t\t// const dayState = this.context.getDay(this.props.date);\n\t\tconst dayState = this.props.day;\n\t\tconst entries = dayState.state.entries;\n\t\t// console.log('componentDidMount', entries);\n\t\tthis.setState(\n\t\t\t{\n\t\t\t\tentries,\n\t\t\t},\n\t\t\t() => {\n\t\t\t\tif (this.state.entries.length === 0) {\n\t\t\t\t\t// this.addRow(null);\n\t\t\t\t}\n\t\t\t},\n\t\t);\n\t}\n\n\tkeydownHandler(e: KeyboardEvent) {\n\t\t// console.log(e.key, e.ctrlKey, e.metaKey);\n\t\tif (e.key === 'Insert') {\n\t\t\t// @ts-ignore\n\t\t\tthis.addRow((e as unknown) as Event);\n\t\t}\n\t\tif (e.key === 'Escape') {\n\t\t\t// console.log(e.key);\n\t\t\tthis.setState({\n\t\t\t\teditable: [],\n\t\t\t});\n\t\t}\n\t}\n\n\trender() {\n\t\t// console.log('DayTable.render', this.props.date);\n\t\treturn (\n\t\t\t<Container fluid={true} id=\"timeTable\" className=\"py-3\">\n\t\t\t\t<Row\n\t\t\t\t\tclassName=\"border-top\"\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tcolor: '#495057',\n\t\t\t\t\t\tbackgroundColor: '#e9ecef',\n\t\t\t\t\t\tborderColor: '#dee2e6',\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<Col>Start Time</Col>\n\t\t\t\t\t<Col className=\"text-right\">End Time</Col>\n\t\t\t\t\t<Col className=\"text-right\">Duration</Col>\n\t\t\t\t\t<Col className=\"text-right\">Earnings</Col>\n\t\t\t\t\t<Col>Comment</Col>\n\t\t\t\t</Row>\n\t\t\t\t{this.state.entries.map((te: TimeEntry, index: number) =>\n\t\t\t\t\tte.end && !this.state.editable[index] ? (\n\t\t\t\t\t\t<TimeEntryRow\n\t\t\t\t\t\t\tdate={this.props.date}\n\t\t\t\t\t\t\ttimeEntry={te}\n\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\tday={this.props.day}\n\t\t\t\t\t\t\tonChange={(form) => this.onChange(form, index)}\n\t\t\t\t\t\t\tmakeEditable={(yesNo) =>\n\t\t\t\t\t\t\t\tthis.makeEditable(index, yesNo)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tremove={() => {}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<TimeEntryEdit\n\t\t\t\t\t\t\tdate={this.props.date}\n\t\t\t\t\t\t\ttimeEntry={te}\n\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\tday={this.props.day}\n\t\t\t\t\t\t\tonChange={(form) => this.onChange(form, index)}\n\t\t\t\t\t\t\tmakeEditable={(yesNo) =>\n\t\t\t\t\t\t\t\tthis.makeEditable(index, yesNo)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tremove={this.remove.bind(this, index, te)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t),\n\t\t\t\t)}\n\t\t\t\t<Row\n\t\t\t\t\tclassName=\"tfoot-light\"\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tcolor: '#495057',\n\t\t\t\t\t\tbackgroundColor: '#e9ecef',\n\t\t\t\t\t\tborderColor: '#dee2e6',\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<Col>\n\t\t\t\t\t\t<a href=\"/addRow\" onClick={this.addRow.bind(this)}>\n\t\t\t\t\t\t\t<FaPlus />\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</Col>\n\t\t\t\t\t{/*<Col>*/}\n\t\t\t\t\t{/*{moment(this.props.date).isSame(moment(), \"day\") ? (*/}\n\t\t\t\t\t{/*  <a href=\"/addPlay\" onClick={this.addPlay.bind(this)}>*/}\n\t\t\t\t\t{/*    <FaPlay />*/}\n\t\t\t\t\t{/*  </a>*/}\n\t\t\t\t\t{/*) : null}*/}\n\t\t\t\t\t{/*</Col>*/}\n\t\t\t\t\t<Col className=\"text-right\">&Sigma; {this.sumTime}</Col>\n\t\t\t\t\t<Col className=\"text-right\">{this.sumHours} h</Col>\n\t\t\t\t\t<Col className=\"text-right\">{this.sumMoney}</Col>\n\t\t\t\t\t<Col />\n\t\t\t\t</Row>\n\t\t\t</Container>\n\t\t);\n\t}\n\n\tonChange(form: HTMLFormElement, index: number) {\n\t\tconsole.log('onChange', index, form);\n\t\tif (form === null) {\n\t\t\treturn;\n\t\t}\n\t\t// @ts-ignore\n\t\tconst eElements = form.querySelectorAll(\n\t\t\t'input, textarea',\n\t\t) as NodeListOf<HTMLInputElement>;\n\t\tconst values = inputElementsToMap(eElements);\n\t\t// console.log(index, values);\n\t\tconst entries: TimeEntry[] = this.state.entries;\n\t\tentries[index] = new TimeEntry(values);\n\t\tthis.setState({\n\t\t\tentries,\n\t\t});\n\t\t// const dayState = this.context.getDay(this.props.date);\n\t\tconst dayState = this.props.day;\n\t\tdayState.updateEntries(this.state.entries);\n\t}\n\n\taddRow(e: React.MouseEvent | null) {\n\t\tif (e) {\n\t\t\te.preventDefault();\n\t\t}\n\t\tconst entries: TimeEntry[] = this.state.entries;\n\n\t\tif (entries.length > 0) {\n\t\t\tconst lastEntry = entries[entries.length - 1];\n\t\t\tlastEntry.finish();\n\t\t}\n\t\tentries.push(\n\t\t\tnew TimeEntry({\n\t\t\t\tstart: moment().subtract(1, 'hour').format('HH:mm'),\n\t\t\t\tend: moment().format('HH:mm'),\n\t\t\t}),\n\t\t); // add current entry to the list\n\n\t\tconst index = entries.length - 1;\n\t\tconst editable = this.state.editable;\n\t\t// @ts-ignore\n\t\teditable[index] = true;\n\n\t\tthis.setState(\n\t\t\t{\n\t\t\t\tentries,\n\t\t\t\teditable,\n\t\t\t},\n\t\t\t() => {\n\t\t\t\t// const dayState = this.context.getDay(this.props.date);\n\t\t\t\tconst dayState = this.props.day;\n\t\t\t\tdayState.updateEntries(entries);\n\t\t\t},\n\t\t);\n\t}\n\n\taddPlay(e: React.MouseEvent | null) {\n\t\tif (e) {\n\t\t\te.preventDefault();\n\t\t}\n\t\tconst entries: TimeEntry[] = this.state.entries;\n\n\t\tif (entries.length > 0) {\n\t\t\tconst lastEntry = entries[entries.length - 1];\n\t\t\tlastEntry.finish();\n\t\t}\n\t\tentries.push(\n\t\t\tnew TimeEntry({\n\t\t\t\tstart: moment().format('HH:mm'),\n\t\t\t}),\n\t\t); // add current entry to the list\n\t\tthis.setState(\n\t\t\t{\n\t\t\t\tentries,\n\t\t\t},\n\t\t\t() => {\n\t\t\t\t// this.context.getDay(this.props.date).updateEntries(entries);\n\t\t\t\t// const dayState = this.context.getDay(this.props.date);\n\t\t\t\tconst dayState = this.props.day;\n\t\t\t\tdayState.updateEntries(entries);\n\t\t\t},\n\t\t);\n\t}\n\n\tmakeEditable(index: number, yesNo: boolean) {\n\t\tconst editable = this.state.editable;\n\t\t// @ts-ignore\n\t\teditable[index] = yesNo;\n\t\tthis.setState({\n\t\t\teditable,\n\t\t});\n\t}\n\n\tremove(index: number, te: TimeEntry) {\n\t\t// this.context.getCurrentEntries().remove(index);\n\t\t// const dayState = this.context.getDay(this.props.date);\n\t\tconsole.log('removing', index);\n\t\tconst dayState = this.props.day;\n\t\tdayState.remove(index);\n\t}\n}\n","export function inputElementsToMap(eElements: NodeListOf<HTMLInputElement>) {\n  const aElements = Array.from(eElements) as HTMLInputElement[];\n  const valueSet = aElements.map(\n    (el: HTMLInputElement | HTMLTextAreaElement) => {\n      // console.log(el);\n      if (el.name) {\n        return { [el.name]: el.value };\n      }\n      return {};\n    }\n  );\n  const values = valueSet.reduce((acc, pair) => {\n    return Object.assign(acc, pair);\n  }, {});\n  return values;\n}\n","import React, { useState, useEffect } from 'react';\n\ntype Props = {\n\tchildren: React.ReactNode;\n\twaitBeforeShow?: number;\n};\n\n// https://stackoverflow.com/questions/30803440/delayed-rendering-of-react-components\nconst Delayed = ({ children, waitBeforeShow = 500 }: Props): JSX.Element => {\n\tconst [isShown, setIsShown] = useState(false);\n\n\tuseEffect(() => {\n\t\tsetTimeout(() => {\n\t\t\tsetIsShown(true);\n\t\t}, waitBeforeShow);\n\t}, [waitBeforeShow]);\n\n\treturn (isShown ? children : null) as JSX.Element;\n};\n\nexport default Delayed;\n","import { Moment } from 'moment';\nimport React from 'react';\nimport { DayProvider } from '../state/DayProvider';\nimport { Entries } from '../state/entries';\n\nfunction ExtractWeekData1({\n\tmonday,\n\tdayProvider,\n\tchildren,\n}: {\n\tmonday: Moment;\n\tdayProvider: DayProvider;\n\tchildren: (dateRange: Entries[]) => JSX.Element;\n}) {\n\tfunction dateRange() {\n\t\tconst dateRange = [];\n\t\tfor (let i = 0; i < 7; i++) {\n\t\t\tconst dayState = dayProvider.getDay(\n\t\t\t\tmonday.clone().add(i, 'days').toDate(),\n\t\t\t);\n\t\t\tdateRange.push(dayState);\n\t\t}\n\t\treturn dateRange;\n\t}\n\n\treturn children(dateRange());\n}\n\nexport const ExtractWeekData = React.memo(\n\tExtractWeekData1,\n\t(a, b) => a.monday.toISOString() === b.monday.toISOString(),\n);\n","import React from 'react';\nimport moment from 'moment';\nimport { Earnings } from '../components/Earnings';\nimport { Entries } from '../state/entries';\n// @ts-ignore\n// import debounceRender from 'react-debounce-render';\n\nconst findHashtags = require('find-hashtags');\n\ninterface Props {\n\tdate: Date;\n\tdateRange: Entries[];\n}\n\nexport class WeekTotalComponent extends React.PureComponent<Props, {}> {\n\t// static contextType = GlobalContext;\n\t// @ts-ignore\n\t// context: AppState;\n\tcontext: undefined;\n\n\tget duration() {\n\t\tlet sum = moment.duration(0);\n\t\tfor (const dayState of this.props.dateRange) {\n\t\t\tsum.add(dayState.sumTime);\n\t\t}\n\t\treturn sum;\n\t}\n\n\tget sumHours() {\n\t\treturn this.duration.asHours().toFixed(2);\n\t}\n\n\tget sumTime() {\n\t\tlet hh = this.duration.get('hours');\n\t\tlet mm = this.duration.get('minutes');\n\t\treturn (\n\t\t\thh.toString().padStart(2, '0') +\n\t\t\t':' +\n\t\t\tmm.toString().padStart(2, '0')\n\t\t);\n\t}\n\n\tget sumMoney() {\n\t\tconst hours = this.duration.asHours();\n\t\t// TODO: rate\n\t\treturn <Earnings hours={hours} rate={50} />;\n\t}\n\n\tget hashtags() {\n\t\tconst tagTimes: { [key: string]: number } = {};\n\t\tfor (const dayState of this.props.dateRange) {\n\t\t\tfor (const te of dayState.state.entries) {\n\t\t\t\tconst tags = findHashtags(te.comment);\n\t\t\t\tfor (const tag of tags) {\n\t\t\t\t\tif (!(tag in tagTimes)) {\n\t\t\t\t\t\ttagTimes[tag] = 0;\n\t\t\t\t\t}\n\t\t\t\t\ttagTimes[tag] += te.duration.asHours();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tconst sorted = Object.entries(tagTimes).sort(\n\t\t\t(a: [string, number], b: [string, number]) => {\n\t\t\t\treturn (b[1] as number) - a[1]; // value\n\t\t\t},\n\t\t);\n\t\treturn Object.fromEntries(sorted);\n\t}\n\n\tget title() {\n\t\treturn (\n\t\t\t<h5 style={{ paddingTop: 0 }}>\n\t\t\t\tWeek #{moment(this.props.date).isoWeek()} total\n\t\t\t</h5>\n\t\t);\n\t}\n\n\trender() {\n\t\tconst hashtags = this.hashtags;\n\t\treturn (\n\t\t\t<div className=\"card w-100\">\n\t\t\t\t<div className=\"jumbotron p-3\">\n\t\t\t\t\t<h1 className=\"display-4 text-center\">{this.sumHours}h</h1>\n\t\t\t\t\t<h3 className=\"lead left\">{this.sumTime}</h3>\n\t\t\t\t\t<h3 className=\"lead text-right\">{this.sumMoney}</h3>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"card-body\">{this.title}</div>\n\t\t\t\t<ul className=\"list-group list-group-flush\">\n\t\t\t\t\t{Object.keys(hashtags).map((tag) => (\n\t\t\t\t\t\t<li\n\t\t\t\t\t\t\tclassName=\"list-group-item d-flex justify-content-between\"\n\t\t\t\t\t\t\tkey={tag}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{tag}\n\t\t\t\t\t\t\t<span className=\"badge badge-primary badge-pill\">\n\t\t\t\t\t\t\t\t{hashtags[tag].toFixed(2)}h\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t))}\n\t\t\t\t</ul>\n\t\t\t\t<div className=\"text-muted\">{Math.random()}</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\n// export const WeekTotal = debounceRender(WeekTotalComponent);\nexport const WeekTotal = WeekTotalComponent;\n","import React from 'react';\nimport moment from 'moment';\nimport { WeekTotalComponent } from './WeekTotal';\n// @ts-ignore\n// import debounceRender from 'react-debounce-render';\n\nexport class MonthTotalComponent extends WeekTotalComponent {\n\tget title() {\n\t\tlet month = moment(this.props.date);\n\t\treturn <h5>Month {month.format('YYYY-MM')} total</h5>;\n\t}\n}\n\n// export const MonthTotal = debounceRender(MonthTotalComponent);\nexport const MonthTotal = React.memo(MonthTotalComponent);\n","import { useCallback, useEffect, useState } from 'react';\nimport { TimeEntry } from '../model/TimeEntry';\nimport { Entries } from '../state/entries';\n\nexport default function ClipboardHandler(props: { day: Entries }) {\n\tconst [clipboard, setClipboard] = useState([] as TimeEntry[]);\n\n\tconst escFunction = useCallback(\n\t\t(event: KeyboardEvent) => {\n\t\t\tif (event.key.toLowerCase() === 'c' && event.ctrlKey) {\n\t\t\t\tconsole.log('Ctrl-C');\n\t\t\t\tlet timeEntries = props.day.state.entries;\n\t\t\t\tsetClipboard(timeEntries.slice());\n\t\t\t\tconsole.log(timeEntries, clipboard);\n\t\t\t} else if (event.key.toLowerCase() === 'v' && event.ctrlKey) {\n\t\t\t\tconsole.log('Ctrl-V');\n\t\t\t\tif (!clipboard) {\n\t\t\t\t\tconsole.log('clipboard is empty');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (props.day.state.entries.length) {\n\t\t\t\t\t// throw new Error(\"Overwriting is dangerous\");\n\t\t\t\t\tconsole.warn('Overwriting is dangerous');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconsole.log(clipboard);\n\t\t\t\tprops.day.updateEntries(clipboard.slice());\n\t\t\t} else if (event.key && event.key !== 'Control') {\n\t\t\t\t// console.log(\n\t\t\t\t//   event.ctrlKey ? \"Ctrl\" : \"\",\n\t\t\t\t//   event.altKey ? \"Alt\" : \"\",\n\t\t\t\t//   event.shiftKey ? \"Shift\" : \"\",\n\t\t\t\t//   event.key\n\t\t\t\t// );\n\t\t\t}\n\t\t},\n\t\t[props.day, clipboard],\n\t);\n\n\tuseEffect(() => {\n\t\tdocument.addEventListener('keydown', escFunction, false);\n\n\t\treturn () => {\n\t\t\tdocument.removeEventListener('keydown', escFunction, false);\n\t\t};\n\t}, [props.day, clipboard, escFunction]);\n\n\treturn <></>;\n}\n","import { Entries } from '../state/entries';\nimport { DayProvider } from '../state/DayProvider';\nimport { DayChart } from '../components/DayChart';\nimport { DayTable } from '../table/DayTable';\nimport Delayed from '../components/delayed';\nimport { ExtractWeekData } from '../stats/extract-week-data';\nimport moment from 'moment';\nimport { WeekTotal } from '../stats/WeekTotal';\nimport { MonthTotal } from '../stats/MonthTotal';\nimport React from 'react';\nimport ClipboardHandler from '../table/clipboard-handler';\n\nexport default function MainPage(props: {\n\tdate: Date;\n\tsetDate: (date: Date) => void;\n\tdayData: Entries;\n\tappState: DayProvider;\n}) {\n\treturn (\n\t\t<>\n\t\t\t<DayChart workEntries={props.dayData.state.entries} />\n\t\t\t<DayTable\n\t\t\t\tdate={props.date}\n\t\t\t\tday={props.dayData}\n\t\t\t\tappState={props.appState}\n\t\t\t/>\n\t\t\t<div\n\t\t\t\tclassName=\"d-flex justify-content-between\"\n\t\t\t\tstyle={{\n\t\t\t\t\tgap: 12,\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{/*<SlowComponentSameProps*/}\n\t\t\t\t{/*\tprop={moment().hour() + ':' + moment().minute()}*/}\n\t\t\t\t{/*/>*/}\n\t\t\t\t<Delayed>\n\t\t\t\t\t<ExtractWeekData\n\t\t\t\t\t\tmonday={moment(props.date).startOf('week')}\n\t\t\t\t\t\tdayProvider={props.appState}\n\t\t\t\t\t>\n\t\t\t\t\t\t{(dateRange) => (\n\t\t\t\t\t\t\t<WeekTotal\n\t\t\t\t\t\t\t\tdate={props.date}\n\t\t\t\t\t\t\t\tdateRange={dateRange}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</ExtractWeekData>\n\t\t\t\t\t<ExtractWeekData\n\t\t\t\t\t\tmonday={moment(props.date).startOf('month')}\n\t\t\t\t\t\tdayProvider={props.appState}\n\t\t\t\t\t>\n\t\t\t\t\t\t{(dateRange) => (\n\t\t\t\t\t\t\t<MonthTotal\n\t\t\t\t\t\t\t\tdate={props.date}\n\t\t\t\t\t\t\t\tdateRange={dateRange}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</ExtractWeekData>\n\t\t\t\t</Delayed>\n\t\t\t</div>\n\t\t\t<ClipboardHandler day={props.dayData} />\n\t\t</>\n\t);\n}\n","import { Route, Switch } from 'react-router-dom';\nimport { GlobalContext } from './state/GlobalContext';\nimport { Report } from './page/Report';\nimport React from 'react';\nimport { SetDate } from './state/DateState';\nimport { DayProvider } from './state/DayProvider';\nimport { Entries } from './state/entries';\nimport MainPage from './page/main-page';\n\ninterface Props {\n\tdate: Date;\n\tsetDate: SetDate;\n\tdayData: Entries;\n\tdayProvider: DayProvider;\n}\n\nexport default function RouterSwitch(props: Props) {\n\tconst date = props.date;\n\tconst setDate = props.setDate;\n\treturn (\n\t\t<Switch>\n\t\t\t<Route exact path=\"/\">\n\t\t\t\t<MainPage\n\t\t\t\t\tdate={date}\n\t\t\t\t\tsetDate={setDate}\n\t\t\t\t\tdayData={props.dayData}\n\t\t\t\t\tappState={props.dayProvider}\n\t\t\t\t/>\n\t\t\t</Route>\n\t\t\t<Route path=\"/report\">\n\t\t\t\t<GlobalContext.Provider value={props.dayProvider}>\n\t\t\t\t\t<Report\n\t\t\t\t\t\tdate={date}\n\t\t\t\t\t\tgetDay={props.dayProvider.getDay.bind(\n\t\t\t\t\t\t\tprops.dayProvider,\n\t\t\t\t\t\t)}\n\t\t\t\t\t/>\n\t\t\t\t</GlobalContext.Provider>\n\t\t\t</Route>\n\t\t</Switch>\n\t);\n}\n","import { useCallback, useEffect } from 'react';\n\nexport default function KeyNav(props: {\n\tincDate: () => void;\n\tdecDate: () => void;\n}) {\n\tconst escFunction = useCallback(\n\t\t(event: KeyboardEvent) => {\n\t\t\tif (event.key === 'ArrowLeft' && event.ctrlKey) {\n\t\t\t\tprops.decDate();\n\t\t\t} else if (event.key === 'ArrowRight' && event.ctrlKey) {\n\t\t\t\tprops.incDate();\n\t\t\t} else if (event.key && event.key !== 'Control') {\n\t\t\t\t// console.log(\n\t\t\t\t//   event.ctrlKey ? \"Ctrl\" : \"\",\n\t\t\t\t//   event.altKey ? \"Alt\" : \"\",\n\t\t\t\t//   event.shiftKey ? \"Shift\" : \"\",\n\t\t\t\t//   event.key\n\t\t\t\t// );\n\t\t\t}\n\t\t},\n\t\t[props],\n\t);\n\n\tuseEffect(() => {\n\t\tdocument.addEventListener('keydown', escFunction, false);\n\n\t\treturn () => {\n\t\t\tdocument.removeEventListener('keydown', escFunction, false);\n\t\t};\n\t}, [props, escFunction]);\n\n\treturn <></>;\n}\n","import React from 'react';\nimport moment from 'moment';\nimport './DayTimeline.scss';\n\ninterface Props {\n\tdate: Date;\n\tsetDate: (date: Date) => void;\n}\n\nexport class DayTimeline extends React.Component<Props, {}> {\n\t// static contextType = GlobalContext;\n\t// @ts-ignore\n\t// context: AppState;\n\tcontext: undefined;\n\n\tmyInput: any;\n\n\tconstructor(props: any) {\n\t\tsuper(props);\n\t\tthis.myInput = React.createRef();\n\t}\n\n\tget range() {\n\t\tif (this.myInput.current) {\n\t\t\treturn Math.round(this.myInput.current.offsetWidth / 32 / 2) - 1;\n\t\t}\n\t\treturn 10;\n\t}\n\n\tkeydownHandler(e: KeyboardEvent) {\n\t\t//console.log(e.key, e.ctrlKey, e.metaKey);\n\t\tconst ctrl = (e.ctrlKey || e.metaKey) && e.shiftKey;\n\t\tif (ctrl && e.key === 'ArrowLeft') {\n\t\t\t// @ts-ignore\n\t\t\tthis.dayClick(\n\t\t\t\t(e as unknown) as React.MouseEvent,\n\t\t\t\tmoment(this.props.date).subtract('1', 'day'),\n\t\t\t);\n\t\t}\n\t\tif (ctrl && e.key === 'ArrowRight') {\n\t\t\t// @ts-ignore\n\t\t\tthis.dayClick(\n\t\t\t\t(e as unknown) as React.MouseEvent,\n\t\t\t\tmoment(this.props.date).add('1', 'day'),\n\t\t\t);\n\t\t}\n\t}\n\n\tcomponentDidMount(): void {\n\t\tdocument.addEventListener('keydown', this.keydownHandler.bind(this));\n\t\tconsole.log('width', this.myInput.current.offsetWidth, 'rerender');\n\t\tif (this.myInput.current) {\n\t\t\twindow.addEventListener('resize', this.handleResize.bind(this));\n\t\t}\n\n\t\tthis.forceUpdate(); // width calculated - re-render with dates\n\t}\n\n\tcomponentWillUnmount(): void {\n\t\tdocument.removeEventListener('keydown', this.keydownHandler.bind(this));\n\t\twindow.removeEventListener('resize', this.handleResize.bind(this));\n\t}\n\n\thandleResize() {\n\t\tconsole.log('resize');\n\t\tthis.forceUpdate();\n\t}\n\n\trender() {\n\t\tconst days = [];\n\t\tconst today = moment(this.props.date);\n\t\tfor (let i = -this.range; i <= this.range; i++) {\n\t\t\tdays.push(today.clone().add(i, 'days'));\n\t\t}\n\n\t\tif (!this.myInput.current) {\n\t\t\treturn (\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"d-flex justify-content-center mb-3\"\n\t\t\t\t\tref={this.myInput}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName=\"d-flex justify-content-center mb-3\"\n\t\t\t\tref={this.myInput}\n\t\t\t>\n\t\t\t\t{days.map((day) => {\n\t\t\t\t\tconst isWeekend = [6, 7].includes(day.isoWeekday())\n\t\t\t\t\t\t? 'weekend'\n\t\t\t\t\t\t: '';\n\t\t\t\t\tconst isToday = day.isSame(this.props.date, 'day')\n\t\t\t\t\t\t? 'today'\n\t\t\t\t\t\t: '';\n\t\t\t\t\tlet dayBox = (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\t\t'dayBox border text-center align-baseline ' +\n\t\t\t\t\t\t\t\t[isWeekend, isToday].join(' ')\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tkey={day.toISOString()}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{day.format('DD')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t);\n\t\t\t\t\tif (day.isSame(this.props.date, 'day')) {\n\t\t\t\t\t\treturn dayBox;\n\t\t\t\t\t}\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<a\n\t\t\t\t\t\t\thref={'/day/' + day.format('YYYY-MM-DD')}\n\t\t\t\t\t\t\tonClick={(e) => this.dayClick(e, day)}\n\t\t\t\t\t\t\tstyle={{ textDecoration: 'none' }}\n\t\t\t\t\t\t\tkey={day.toISOString()}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{dayBox}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t);\n\t\t\t\t})}\n\t\t\t</div>\n\t\t);\n\t}\n\n\tdayClick(e: React.MouseEvent, date: moment.Moment) {\n\t\te.preventDefault();\n\t\tthis.props.setDate(date.toDate());\n\t}\n}\n","import { DateState, SetDate } from '../state/DateState';\nimport { Entries } from '../state/entries';\nimport { DayProvider } from '../state/DayProvider';\nimport { Header } from '../components/Header';\nimport moment from 'moment';\nimport RouterSwitch from '../router-switch';\nimport KeyNav from '../components/key-nav';\nimport { Col, Row } from 'react-bootstrap';\nimport React from 'react';\nimport { DayTimeline } from '../components/DayTimeline';\n\nexport default function Layout(props: {\n\tdate: Date;\n\tsetDate: SetDate;\n\tdayData: Entries;\n\tdayProvider: DayProvider;\n\tdateState: DateState;\n}) {\n\treturn (\n\t\t<>\n\t\t\t<Header\n\t\t\t\tdate={moment(props.date)}\n\t\t\t\tday={props.dayData}\n\t\t\t\tsetDate={props.setDate}\n\t\t\t/>\n\t\t\t<main role=\"main\" className=\"container-fluid\">\n\t\t\t\t<div className=\"h-100\">\n\t\t\t\t\t<DayTimeline date={props.date} setDate={props.setDate} />\n\t\t\t\t\t<RouterSwitch\n\t\t\t\t\t\tdate={props.date}\n\t\t\t\t\t\tsetDate={props.setDate}\n\t\t\t\t\t\tdayData={props.dayData}\n\t\t\t\t\t\tdayProvider={props.dayProvider}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</main>\n\t\t\t<KeyNav\n\t\t\t\tincDate={props.dateState.incDate.bind(props.dateState)}\n\t\t\t\tdecDate={props.dateState.decDate.bind(props.dateState)}\n\t\t\t/>\n\t\t\t<footer className=\"container-fluid mt-3 pt-2 border-top\">\n\t\t\t\t<div className=\"inner\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t&copy; 2021{' '}\n\t\t\t\t\t\t<a href=\"https://github.com/spidgorny/\">Slawa</a>\n\t\t\t\t\t</div>\n\t\t\t\t\t<Row>\n\t\t\t\t\t\t<Col>\n\t\t\t\t\t\t\t<kbd>Ins</kbd>: new line, <kbd>Ctrl-Enter</kbd>:\n\t\t\t\t\t\t\tsave, <kbd>Ctrl-Backspace</kbd>: remove\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t<Col>\n\t\t\t\t\t\t\t<kbd>Ctrl-C</kbd>, <kbd>Ctrl-V</kbd>: clipboard\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t</Row>\n\t\t\t\t</div>\n\t\t\t</footer>\n\t\t</>\n\t);\n}\n","import { DayProvider } from '../state/DayProvider';\nimport { useCallback, useEffect } from 'react';\nimport moment from 'moment';\nimport { TimeEntry } from '../model/TimeEntry';\n\n/// https://stackoverflow.com/questions/19721439/download-json-object-as-a-file-from-browser\nfunction downloadObjectAsJson(exportObj: object, exportName: string) {\n\tconst dataStr =\n\t\t'data:text/json;charset=utf-8,' +\n\t\tencodeURIComponent(JSON.stringify(exportObj, null, 2));\n\tconst downloadAnchorNode = document.createElement('a');\n\tdownloadAnchorNode.setAttribute('href', dataStr);\n\tdownloadAnchorNode.setAttribute('download', exportName + '.json');\n\tdocument.body.appendChild(downloadAnchorNode); // required for firefox\n\tdownloadAnchorNode.click();\n\tdownloadAnchorNode.remove();\n}\n\nexport default function HandleSave(props: { dayProvider: DayProvider }) {\n\tconst onKeyDown = useCallback(\n\t\t(e: KeyboardEvent) => {\n\t\t\tif (e.key === 's' && e.ctrlKey) {\n\t\t\t\te.preventDefault();\n\t\t\t\t// console.log('Ctrl-S');\n\t\t\t\tconst year = 2020;\n\t\t\t\tconst yearDates: Date[] = [];\n\t\t\t\tlet start = moment().year(year).startOf('year');\n\t\t\t\t// console.log('start', start.toISOString());\n\t\t\t\tconst end = moment(start).add(1, 'year');\n\t\t\t\t// console.log('end', end.toISOString());\n\t\t\t\t// console.log('isBefore', start.isBefore(end));\n\t\t\t\twhile (start.isBefore(end)) {\n\t\t\t\t\tyearDates.push(start.toDate());\n\t\t\t\t\tstart = start.add(1, 'day');\n\t\t\t\t}\n\t\t\t\tconsole.log('yearDates', yearDates.length);\n\t\t\t\tconst data: Record<string, TimeEntry[]> = {};\n\t\t\t\tfor (const date of yearDates) {\n\t\t\t\t\tconst entries = props.dayProvider.getDay(date);\n\t\t\t\t\tif (entries.state.entries.length) {\n\t\t\t\t\t\tdata[\n\t\t\t\t\t\t\tmoment(date).format('YYYY-MM-DD')\n\t\t\t\t\t\t] = entries.state.entries.slice();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// console.log(data);\n\t\t\t\tdownloadObjectAsJson(\n\t\t\t\t\t{\n\t\t\t\t\t\tsignature: 'excel-time-tracking',\n\t\t\t\t\t\tyear: year,\n\t\t\t\t\t\tdata,\n\t\t\t\t\t},\n\t\t\t\t\t'excel-time-tracking-' + year,\n\t\t\t\t);\n\t\t\t}\n\t\t},\n\t\t[props.dayProvider],\n\t);\n\n\tuseEffect(() => {\n\t\twindow.addEventListener('keydown', onKeyDown);\n\t\treturn () => {\n\t\t\twindow.removeEventListener('keydown', onKeyDown);\n\t\t};\n\t}, [onKeyDown]);\n\n\treturn <></>;\n}\n","import React from 'react';\nimport './App.css';\nimport { Router } from 'react-router-dom';\nimport { createBrowserHistory } from 'history';\nimport { DayProvider } from './state/DayProvider';\nimport { DateState, SetDate } from './state/DateState';\nimport { Entries } from './state/entries';\nimport Layout from './page/layout';\nimport HandleSave from './table/handle-save';\n\nexport const history = createBrowserHistory();\nexport var DateContext = React.createContext(new Date());\n\nexport class App extends React.Component<any, any> {\n\t// static contextType = GlobalContext;\n\t// @ts-ignore\n\t// context: AppState;\n\tcontext: undefined;\n\n\tstate: {} = {};\n\n\trender() {\n\t\treturn (\n\t\t\t<DateState>\n\t\t\t\t{(date: Date, setDate: SetDate, dateState: DateState) => (\n\t\t\t\t\t<DayProvider date={date}>\n\t\t\t\t\t\t{(day: Entries, dayProvider: DayProvider) => (\n\t\t\t\t\t\t\t<Router history={history}>\n\t\t\t\t\t\t\t\t<Layout\n\t\t\t\t\t\t\t\t\tdate={date}\n\t\t\t\t\t\t\t\t\tdayData={day}\n\t\t\t\t\t\t\t\t\tsetDate={setDate}\n\t\t\t\t\t\t\t\t\tdayProvider={dayProvider}\n\t\t\t\t\t\t\t\t\tdateState={dateState}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<HandleSave dayProvider={dayProvider} />\n\t\t\t\t\t\t\t</Router>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</DayProvider>\n\t\t\t\t)}\n\t\t\t</DateState>\n\t\t);\n\t}\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}