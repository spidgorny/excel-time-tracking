{"version":3,"sources":["state/Storage.ts","model/TimeEntry.ts","model/POJO.ts","functions.ts","state/entries.ts","state/DayProvider.tsx","state/DateState.tsx","components/Header.tsx","state/GlobalContext.ts","components/Earnings.tsx","page/Report.tsx","components/DayChart.tsx","table/TimeEntryRow.tsx","table/TimeEntryEdit.tsx","table/DayTable.tsx","components/delayed.tsx","stats/extract-week-data.tsx","stats/WeekTotal.tsx","stats/MonthTotal.tsx","table/clipboard-handler.tsx","page/main-page.tsx","page/sap.tsx","router-switch.tsx","components/key-nav.tsx","components/DayTimeline.tsx","page/layout.tsx","table/handle-save.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["Storage","_storage","window","localStorage","_callbacks","name","defaultValue","val","this","getItem","JSON","parse","value","setItem","stringify","call","comment","index","push","console","log","TimeEntry","props","start","end","Object","assign","getStartMoment","getEndMoment","moment","duration","diff","date","Date","split","hr","min","iHr","parseInt","iMin","hours","minutes","now","getHours","getMinutes","format","join","key","hasOwnProperty","humanTime","input","hh","get","mm","toString","padStart","Entries","storage","entries","fetch","map","el","filter","state","sumTime","asHours","toFixed","reduce","acc","te","add","time","update","timeEnd","setState","timeEntry","timeEntries","findIndex","updateEntries","error","splice","e","hash","children","React","Component","DayProvider","rate","data","dayData","DateState","toISOString","setDate","toDate","subtract","Fragment","bind","HeaderClass","context","focused","isAfter","endOf","day","length","className","Navbar","Brand","href","onDateChange","onFocusChange","x","id","isOutsideRange","isDayHighlighted","initialVisibleMonth","type","Collapse","location","pathname","to","Header","withRouter","GlobalContext","createContext","undefined","currencies","require","Earnings","byCountry","countryCode","navigator","language","substr","currency","amount","result","Intl","NumberFormat","style","onClick","askPrice","price","prompt","iPrice","parseFloat","setRate","contextType","Report","daysInMonth","days","Array","from","i","startOf","dayRepo","getDay","Table","as","entry","sumTimeString","sumHoursString","sumHours","DayChart","position","height","border","top","left","width","borderRight","color","flex","textAlign","workEntries","mmtMidnight","clone","offset","background","opacity","TimeEntryRow","dur","Row","Col","makeEditable","startValue","endValue","earnings","TimeEntryEdit","timer","formRef","textInput","createRef","keydownHandler","ctrlKey","preventDefault","submit","remove","document","addEventListener","current","focus","removeEventListener","onChange","Form","ref","onSubmit","form","play","endOutput","stop","placeholder","updateOne","startTimer","setInterval","forceUpdate","stopTimer","clearInterval","DayTable","editable","prevProps","addRow","Container","fluid","backgroundColor","borderColor","yesNo","values","eElements","pair","inputElementsToMap","querySelectorAll","finish","Delayed","waitBeforeShow","useState","isShown","setIsShown","useEffect","setTimeout","ExtractWeekData1","monday","dayProvider","dateRange","dayState","ExtractWeekData","memo","a","b","findHashtags","WeekTotalComponent","sum","tagTimes","tags","tag","sorted","sort","fromEntries","paddingTop","isoWeek","hashtags","sumMoney","title","keys","Math","random","PureComponent","WeekTotal","MonthTotalComponent","month","MonthTotal","ClipboardHandler","clipboard","setClipboard","escFunction","useCallback","event","toLowerCase","slice","warn","MainPage","appState","gap","SAP","startOfWeek","dataMap","week","includes","isoWeekday","beforeLunch","afterLunch1","afterLunch2","RouterSwitch","exact","path","KeyNav","decDate","incDate","DayTimeline","myInput","handleResize","round","offsetWidth","ctrl","metaKey","shiftKey","dayClick","today","range","isWeekend","isToday","isSame","dayBox","textDecoration","Layout","role","dateState","HandleSave","onKeyDown","year","yearDates","isBefore","exportObj","exportName","dataStr","encodeURIComponent","downloadAnchorNode","createElement","setAttribute","body","appendChild","click","downloadObjectAsJson","signature","history","createBrowserHistory","App","Boolean","hostname","match","ReactDOM","render","StrictMode","getElementById","serviceWorker","ready","then","registration","unregister","catch","message"],"mappings":"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","file":"static/js/main.fe3910e3.chunk.js","sourcesContent":["export class Storage {\n\t_storage = window.localStorage;\n\n\t_callbacks: Function[] = [];\n\n\tfetch(name: string, defaultValue: any = null) {\n\t\tconst val = this._storage.getItem(name);\n\t\tif (!val) {\n\t\t\treturn defaultValue;\n\t\t}\n\t\treturn JSON.parse(val);\n\t}\n\n\tupdate(name: string, value: any) {\n\t\tthis._storage.setItem(name, JSON.stringify(value));\n\t}\n\n\tsubscribe(call: Function, comment?: string) {\n\t\tlet index = this._callbacks.push(call) - 1;\n\t\tconsole.log('subscribe', index, call.name, comment);\n\t\treturn index;\n\t}\n\n\tunsubscribe(index: number, comment?: string) {\n\t\tconsole.log('unsubscribe', index, comment);\n\t\tdelete this._callbacks[index];\n\t}\n\n\tnotify() {\n\t\t// console.log(\"notify\", this._callbacks.length);\n\t\t// for (const callMe of this._callbacks) {\n\t\t// console.time(callMe.name);\n\t\t// callMe && callMe();\n\t\t// console.timeEnd(callMe.name);\n\t\t// }\n\t}\n}\n","import { POJO } from \"./POJO\";\nimport moment from \"moment\";\n\nexport class TimeEntry extends POJO {\n  // @ts-ignore\n  start: string;\n  end: string | undefined;\n  comment: string | undefined;\n\n  constructor(props: any = {}) {\n    super(props);\n    Object.assign(this, props);\n  }\n\n  get duration() {\n    const start = this.getStartMoment();\n    const end = this.getEndMoment();\n    const dur = moment.duration(end.diff(start));\n    return dur;\n  }\n\n  getStartMoment() {\n    const date = new Date();\n    const [hr, min] = this.start.split(\":\");\n    const iHr = parseInt(hr, 10);\n    const iMin = parseInt(min, 10);\n    const from = moment(date).hours(iHr).minutes(iMin);\n    return from;\n  }\n\n  // returns now() if no end time specified\n  getEndMoment() {\n    const date = new Date();\n    if (!this.end) {\n      const now = new Date();\n      return moment(date).hours(now.getHours()).minutes(now.getMinutes());\n    }\n    const [hr, min] = this.end.split(\":\");\n    const iHr = parseInt(hr, 10);\n    const iMin = parseInt(min, 10);\n    const till = moment(date).hours(iHr).minutes(iMin);\n    return till;\n  }\n\n  finish() {\n    if (!this.end) {\n      this.end = moment().format(\"HH:mm\");\n    }\n  }\n\n  hash() {\n    return [this.start, this.end, this.comment].join(\".\");\n  }\n}\n","export class POJO {\n  // [key: string]: any;\n\n  constructor(props: any) {\n    Object.assign(this, props);\n  }\n\n  assignProps(props: any) {\n    for (const key in props) {\n      if (props.hasOwnProperty(key)) {\n        console.log(\"this[\", key, \"] = \", props[key]);\n        // @ts-ignore\n        this[key] = props[key];\n      }\n    }\n  }\n\n  toJson() {\n    return JSON.stringify(this);\n  }\n}\n","import moment, { Duration } from 'moment';\n\nexport function inputElementsToMap(eElements: NodeListOf<HTMLInputElement>) {\n\tconst aElements = Array.from(eElements) as HTMLInputElement[];\n\tconst valueSet = aElements.map(\n\t\t(el: HTMLInputElement | HTMLTextAreaElement) => {\n\t\t\t// console.log(el);\n\t\t\tif (el.name) {\n\t\t\t\treturn { [el.name]: el.value };\n\t\t\t}\n\t\t\treturn {};\n\t\t},\n\t);\n\tconst values = valueSet.reduce((acc, pair) => {\n\t\treturn Object.assign(acc, pair);\n\t}, {});\n\treturn values;\n}\n\nexport function humanTime(input: Duration | number) {\n\tlet duration: Duration;\n\tif (typeof input === 'object') {\n\t\tduration = input;\n\t} else {\n\t\tduration = moment.duration(input, 'hours');\n\t}\n\tlet hh = duration.get('hours');\n\tlet mm = duration.get('minutes');\n\treturn (\n\t\thh.toString().padStart(2, '0') + ':' + mm.toString().padStart(2, '0')\n\t);\n}\n","import { Storage } from './Storage';\nimport moment from 'moment';\nimport { TimeEntry } from '../model/TimeEntry';\nimport React from 'react';\nimport { humanTime } from '../functions';\n\ninterface Props {\n\tdate: Date;\n\tchildren: (dayData: Entries) => JSX.Element;\n}\n\ninterface State {\n\tentries: TimeEntry[];\n}\n\nexport class Entries extends React.Component<Props, State> {\n\tstorage: Storage;\n\n\tconstructor(props: Props) {\n\t\tsuper(props);\n\t\tthis.storage = new Storage();\n\t\t// console.time('DaysState ' + this.key);\n\t\tconst entries = this.storage\n\t\t\t.fetch(this.key, [])\n\t\t\t.map((el: any) => new TimeEntry(el))\n\t\t\t.filter((el: TimeEntry) => el.start);\n\t\t// console.timeEnd('DaysState ' + this.key);\n\t\t// @ts-ignore\n\t\t// noinspection JSConstantReassignment\n\t\tthis.state = {\n\t\t\tentries,\n\t\t};\n\t}\n\n\tget key() {\n\t\tconst ymd = moment(this.props.date).format('YYYY-MM-DD');\n\t\treturn 'date.' + ymd + '.entries';\n\t}\n\n\tget sumHoursString() {\n\t\t// const dayState = this.context.getDay(this.props.date);\n\t\tconst dayState = this;\n\t\treturn dayState.sumTime.asHours().toFixed(2);\n\t}\n\n\tget sumTimeString() {\n\t\treturn humanTime(this.sumTime);\n\t}\n\n\tget sumHours() {\n\t\t// const dayState = this.context.getDay(this.props.date);\n\t\tconst dayState = this;\n\t\tconst hours = dayState.sumTime.asHours();\n\t\treturn hours;\n\t}\n\n\tget sumTime(): moment.Duration {\n\t\tconst sum = this.state.entries.reduce(\n\t\t\t(acc: moment.Duration, te: TimeEntry) => te.duration.add(acc),\n\t\t\tmoment.duration(0),\n\t\t);\n\t\treturn sum;\n\t}\n\n\tupdateEntries(entries: TimeEntry[]) {\n\t\tconsole.time('DayState WRITE ' + this.key);\n\t\tthis.storage.update(this.key, entries);\n\t\tconsole.timeEnd('DayState WRITE ' + this.key);\n\t\tthis.setState({\n\t\t\tentries,\n\t\t});\n\t}\n\n\tupdateOne(timeEntry: TimeEntry) {\n\t\tlet timeEntries = this.state.entries;\n\t\tconst index = timeEntries.findIndex((el) => el === timeEntry);\n\t\tif (index === -1) {\n\t\t\tconsole.error('index in updateOne not found');\n\t\t\treturn;\n\t\t}\n\t\ttimeEntries[index] = timeEntry;\n\t\tthis.updateEntries(timeEntries);\n\t}\n\n\tremove(index: number) {\n\t\tthis.state.entries.splice(index, 1);\n\t\tthis.storage.update(this.key, this.state.entries);\n\t\tthis.setState({\n\t\t\tentries: this.state.entries,\n\t\t});\n\t}\n\n\thash() {\n\t\treturn [\n\t\t\tthis.props.date,\n\t\t\t...this.state.entries.map((e) => e.hash()),\n\t\t].join('.');\n\t}\n\n\trender() {\n\t\treturn this.props.children(this);\n\t}\n}\n","import { Storage } from './Storage';\nimport { Entries } from './entries';\nimport React from 'react';\n\ninterface Props {\n\tdate: Date;\n\tchildren: (day: Entries, dayProvider: DayProvider) => JSX.Element;\n}\n\ninterface State {\n\trate: number;\n}\n\nexport class DayProvider extends React.Component<Props, State> {\n\tstorage: Storage;\n\n\t// @ts-ignore\n\tstate: State = {};\n\n\tconstructor(props: any) {\n\t\tsuper(props);\n\t\tthis.storage = new Storage();\n\t\tthis.state.rate = this.storage.fetch('rate', 50);\n\t}\n\n\tsetRate(rate: number) {\n\t\tthis.setState({\n\t\t\trate,\n\t\t});\n\t}\n\n\t/// read-only for reports, changes will not be saved\n\tgetDay(date: Date) {\n\t\tconst ds = new Entries({\n\t\t\tdate,\n\t\t\tchildren: (data: Entries) => {\n\t\t\t\treturn <></>;\n\t\t\t},\n\t\t});\n\t\treturn ds;\n\t}\n\n\trender() {\n\t\t// console.warn('DayProvider', moment(this.props.date).toISOString());\n\t\treturn (\n\t\t\t<Entries date={this.props.date}>\n\t\t\t\t{(dayData: Entries) => {\n\t\t\t\t\tconsole.log(dayData.state.entries);\n\t\t\t\t\treturn this.props.children(dayData, this);\n\t\t\t\t}}\n\t\t\t</Entries>\n\t\t);\n\t}\n}\n","import React, { PropsWithChildren } from 'react';\nimport moment from 'moment';\nimport { Storage } from './Storage';\n\ninterface State {\n\tdate: Date;\n}\n\nexport type SetDate = (date: Date) => void;\n\ninterface Props {\n\tchildren: (\n\t\tdate: Date,\n\t\tsetDate: SetDate,\n\t\tdateState: DateState,\n\t) => JSX.Element;\n}\n\nexport class DateState extends React.Component<\n\tPropsWithChildren<Props>,\n\tState\n> {\n\tstorage: Storage;\n\n\tstate: State = {\n\t\tdate: new Date(),\n\t};\n\n\tconstructor(props: any) {\n\t\tsuper(props);\n\t\tthis.storage = new Storage();\n\t\tthis.state.date = this.storage.fetch('date', this.state.date);\n\t}\n\n\tsetDate(date: Date) {\n\t\tconsole.log('setDate', moment(date).toISOString());\n\t\tthis.storage.update('date', date);\n\t\tthis.setState({\n\t\t\tdate,\n\t\t});\n\t}\n\n\tincDate() {\n\t\tthis.setDate(moment(this.state.date).add(1, 'day').toDate());\n\t}\n\n\tdecDate() {\n\t\tthis.setDate(moment(this.state.date).subtract(1, 'day').toDate());\n\t}\n\n\trender() {\n\t\tconsole.log('DateState render', moment(this.state.date).toISOString());\n\t\treturn (\n\t\t\t<React.Fragment key={this.state.date.toString()}>\n\t\t\t\t{this.props.children(\n\t\t\t\t\tthis.state.date,\n\t\t\t\t\tthis.setDate.bind(this),\n\t\t\t\t\tthis,\n\t\t\t\t)}\n\t\t\t</React.Fragment>\n\t\t);\n\t}\n}\n","import React from 'react';\nimport { Link, withRouter } from 'react-router-dom';\n// @ts-ignore\nimport { SingleDatePicker } from 'react-dates';\nimport 'react-dates/lib/css/_datepicker.css';\nimport 'react-dates/initialize';\nimport moment from 'moment';\nimport { Entries } from '../state/entries';\nimport Navbar from 'react-bootstrap/Navbar';\nimport { RouteComponentProps } from 'react-router';\n\ninterface IHeaderProps extends RouteComponentProps {\n\tdate: moment.Moment;\n\tday: Entries;\n\tsetDate: (date: Date) => void;\n}\n\nclass HeaderClass extends React.Component<\n\tIHeaderProps,\n\t{\n\t\tfocused: boolean;\n\t}\n> {\n\t// static contextType = GlobalContext;\n\t// @ts-ignore\n\t// context: AppState;\n\tcontext: undefined;\n\n\tstate = {\n\t\tfocused: false,\n\t};\n\n\tisOutsideRange(date: moment.Moment) {\n\t\tif (date.isAfter(moment().endOf('day'))) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tisDayHighlighted(date: moment.Moment) {\n\t\t// const dayState = this.context.getDay(date.toDate());\n\t\tconst dayState = this.props.day;\n\t\treturn dayState.state.entries.length > 0;\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<header className=\"mb-3\">\n\t\t\t\t<Navbar className=\"navbar navbar-expand-lg navbar-light bg-light\">\n\t\t\t\t\t<Navbar.Brand className=\"navbar-brand\">\n\t\t\t\t\t\t<a href=\".\">excel-time-tracking</a>\n\t\t\t\t\t</Navbar.Brand>\n\t\t\t\t\t<SingleDatePicker\n\t\t\t\t\t\tdate={this.props.date} // momentPropTypes.momentObj or null\n\t\t\t\t\t\tonDateChange={(date: moment.Moment) =>\n\t\t\t\t\t\t\tthis.setDate(date)\n\t\t\t\t\t\t} // PropTypes.func.isRequired\n\t\t\t\t\t\tfocused={this.state.focused} // PropTypes.bool\n\t\t\t\t\t\tonFocusChange={(x: any) =>\n\t\t\t\t\t\t\tthis.setState({ focused: x.focused })\n\t\t\t\t\t\t} // PropTypes.func.isRequired\n\t\t\t\t\t\tid=\"your_unique_id\" // PropTypes.string.isRequired,\n\t\t\t\t\t\tisOutsideRange={this.isOutsideRange.bind(this)}\n\t\t\t\t\t\tisDayHighlighted={this.isDayHighlighted.bind(this)}\n\t\t\t\t\t\tinitialVisibleMonth={() => moment().endOf('month')}\n\t\t\t\t\t/>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclassName=\"navbar-toggler\"\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\tdata-toggle=\"collapse\"\n\t\t\t\t\t\tdata-target=\"#navbarNav\"\n\t\t\t\t\t\taria-controls=\"navbarNav\"\n\t\t\t\t\t\taria-expanded=\"false\"\n\t\t\t\t\t\taria-label=\"Toggle navigation\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span className=\"navbar-toggler-icon\" />\n\t\t\t\t\t</button>\n\n\t\t\t\t\t<Navbar.Collapse\n\t\t\t\t\t\tclassName=\"collapse navbar-collapse justify-content-between\"\n\t\t\t\t\t\tid=\"navbarNav\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div />\n\t\t\t\t\t\t<div className=\"navbar-nav\">\n\t\t\t\t\t\t\t<Link\n\t\t\t\t\t\t\t\tclassName={[\n\t\t\t\t\t\t\t\t\t'nav-link',\n\t\t\t\t\t\t\t\t\tthis.props.location.pathname === '/'\n\t\t\t\t\t\t\t\t\t\t? 'active'\n\t\t\t\t\t\t\t\t\t\t: '',\n\t\t\t\t\t\t\t\t].join(' ')}\n\t\t\t\t\t\t\t\tto=\"/\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tHome\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t<Link\n\t\t\t\t\t\t\t\tclassName={[\n\t\t\t\t\t\t\t\t\t'nav-link',\n\t\t\t\t\t\t\t\t\tthis.props.location.pathname === '/report'\n\t\t\t\t\t\t\t\t\t\t? 'active'\n\t\t\t\t\t\t\t\t\t\t: '',\n\t\t\t\t\t\t\t\t].join(' ')}\n\t\t\t\t\t\t\t\tto=\"/report\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tReport\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t<Link\n\t\t\t\t\t\t\t\tclassName={[\n\t\t\t\t\t\t\t\t\t'nav-link',\n\t\t\t\t\t\t\t\t\tthis.props.location.pathname === '/sap'\n\t\t\t\t\t\t\t\t\t\t? 'active'\n\t\t\t\t\t\t\t\t\t\t: '',\n\t\t\t\t\t\t\t\t].join(' ')}\n\t\t\t\t\t\t\t\tto=\"/sap\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tSAP\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Navbar.Collapse>\n\t\t\t\t</Navbar>\n\t\t\t</header>\n\t\t);\n\t}\n\n\tlogout(e: React.MouseEvent) {}\n\n\tsetDate(date: moment.Moment) {\n\t\tconsole.log(date);\n\t\t// this.context.setDate(date.toDate());\n\t\tthis.props.setDate(date.toDate());\n\t}\n}\n\nexport var Header = withRouter(HeaderClass);\n","import React from 'react';\nimport { DayProvider } from './DayProvider';\n\nexport var GlobalContext = React.createContext(\n\t(undefined as unknown) as DayProvider,\n);\n","import React from 'react';\nimport { DayProvider } from '../state/DayProvider';\nimport { GlobalContext } from '../state/GlobalContext';\n\nconst currencies = require('country-currency');\n\ninterface Props {\n\trate: number;\n\thours: number;\n}\n\nexport class Earnings extends React.Component<Props, {}> {\n\tstatic contextType = GlobalContext;\n\t// @ts-ignore\n\tcontext: DayProvider;\n\n\trender() {\n\t\tconst byCountry = currencies.byCountry();\n\t\tlet countryCode = navigator.language.substr(3);\n\t\tconst currency = byCountry.get(countryCode);\n\t\t// console.log(countryCode, currency);\n\t\tconst rate = this.props.rate;\n\n\t\tconst amount = this.props.hours * rate;\n\t\tconst result = new Intl.NumberFormat(undefined, {\n\t\t\tstyle: 'currency',\n\t\t\tcurrency,\n\t\t}).format(amount);\n\t\treturn <span onClick={this.askPrice.bind(this)}>{result}</span>;\n\t}\n\n\taskPrice() {\n\t\tconst price = prompt('Price per Hour?');\n\t\tif (!price) {\n\t\t\treturn;\n\t\t}\n\t\tconst iPrice = parseFloat(price);\n\t\tif (!iPrice) {\n\t\t\treturn;\n\t\t}\n\t\tthis.context.setRate(iPrice);\n\t}\n}\n","import React from 'react';\nimport moment from 'moment';\nimport Table from 'react-bootstrap/Table';\nimport { Entries } from '../state/entries';\nimport { Earnings } from '../components/Earnings';\n\ninterface IReportProps {\n\tdate: Date;\n\tgetDay: (date: Date) => Entries;\n}\n\ninterface IReportState {}\n\nexport class Report extends React.Component<IReportProps, IReportState> {\n\t// static contextType = GlobalContext;\n\t// @ts-ignore\n\t// context: AppState;\n\tcontext: undefined;\n\n\tstate: IReportState = {};\n\n\trender() {\n\t\tlet daysInMonth = moment(this.props.date).daysInMonth();\n\t\tconst days = Array.from(new Array(daysInMonth), (x, i) => i + 1);\n\t\t//console.log(days);\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t{days.map((day) => {\n\t\t\t\t\tconst date = moment(this.props.date)\n\t\t\t\t\t\t.startOf('month')\n\t\t\t\t\t\t.date(day);\n\t\t\t\t\tlet dayRepo: Entries = this.props.getDay(date.toDate());\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<h3 key={day}>\n\t\t\t\t\t\t\t\t{date.format('YYYY-MM-DD')}\n\t\t\t\t\t\t\t\t{dayRepo.sumTime.asHours() === 0\n\t\t\t\t\t\t\t\t\t? null\n\t\t\t\t\t\t\t\t\t: ': ' +\n\t\t\t\t\t\t\t\t\t  dayRepo.sumTime.asHours().toFixed(2) +\n\t\t\t\t\t\t\t\t\t  ' h'}\n\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t\t<Table as=\"table\">\n\t\t\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t\t\t{dayRepo.state.entries.map((entry) => (\n\t\t\t\t\t\t\t\t\t\t<tr key={entry.hash()}>\n\t\t\t\t\t\t\t\t\t\t\t<td>{entry.start}</td>\n\t\t\t\t\t\t\t\t\t\t\t<td>{entry.end}</td>\n\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t{entry.duration\n\t\t\t\t\t\t\t\t\t\t\t\t\t.asHours()\n\t\t\t\t\t\t\t\t\t\t\t\t\t.toFixed(2)}{' '}\n\t\t\t\t\t\t\t\t\t\t\t\th\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t<td>{entry.comment}</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</tbody>\n\t\t\t\t\t\t\t\t<tfoot>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t''{' '}\n\t\t\t\t\t\t\t\t\t\t<td className=\"\">\n\t\t\t\t\t\t\t\t\t\t\t&Sigma; {dayRepo.sumTimeString}\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t''{' '}\n\t\t\t\t\t\t\t\t\t\t<td className=\"\">\n\t\t\t\t\t\t\t\t\t\t\t{dayRepo.sumHoursString} h\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t''{' '}\n\t\t\t\t\t\t\t\t\t\t<td className=\"\">\n\t\t\t\t\t\t\t\t\t\t\t<Earnings\n\t\t\t\t\t\t\t\t\t\t\t\thours={dayRepo.sumHours}\n\t\t\t\t\t\t\t\t\t\t\t\trate={50}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t<td />\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t</tfoot>\n\t\t\t\t\t\t\t</Table>\n\t\t\t\t\t\t</>\n\t\t\t\t\t);\n\t\t\t\t})}\n\t\t\t</div>\n\t\t);\n\t}\n}\n","import React from 'react';\nimport { TimeEntry } from '../model/TimeEntry';\nimport './DayTimeline.scss';\n\ninterface IDayTimelineProps {\n\tworkEntries: TimeEntry[];\n}\n\ninterface IDayTimelineState {}\n\nexport class DayChart extends React.Component<\n\tIDayTimelineProps,\n\tIDayTimelineState\n> {\n\t// static contextType = GlobalContext;\n\t// @ts-ignore\n\t// context: AppState;\n\tcontext: undefined;\n\n\tstate: IDayTimelineState = {};\n\n\trender() {\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName=\"mb-3\"\n\t\t\t\tstyle={{\n\t\t\t\t\tposition: 'relative',\n\t\t\t\t\theight: '1.55em',\n\t\t\t\t\tborder: 'solid 1px silver',\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\tleft: 0,\n\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<div className=\"d-flex justify-content-between\">\n\t\t\t\t\t\t{Array.from(new Array(24), (x, i) => i).map((hr) => {\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tkey={hr}\n\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\tborderRight: 'solid 1px silver',\n\t\t\t\t\t\t\t\t\t\tcolor: 'silver',\n\t\t\t\t\t\t\t\t\t\tflex: '1 1 0px',\n\t\t\t\t\t\t\t\t\t\theight: '1.5em',\n\t\t\t\t\t\t\t\t\t\ttextAlign: 'center',\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{hr % 2 === 0 ? hr : null}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\tleft: 0,\n\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{this.props.workEntries.map((entry) => {\n\t\t\t\t\t\tconst start = entry.getStartMoment();\n\t\t\t\t\t\tconst end = entry.getEndMoment();\n\t\t\t\t\t\tconst duration = end.diff(start, 'minutes');\n\t\t\t\t\t\tconst width = (duration / 24 / 60) * 100;\n\n\t\t\t\t\t\tconst mmtMidnight = start.clone().startOf('day');\n\t\t\t\t\t\tconst offset =\n\t\t\t\t\t\t\t(start.diff(mmtMidnight, 'minutes') / 24 / 60) *\n\t\t\t\t\t\t\t100;\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tkey={entry.start}\n\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\tbackground: '#009ACD',\n\t\t\t\t\t\t\t\t\theight: '1.5em',\n\t\t\t\t\t\t\t\t\twidth: width + '%',\n\t\t\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t\t\tleft: offset + '%',\n\t\t\t\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\t\t\t\topacity: 0.5,\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n","import React from 'react';\nimport { TimeEntry } from '../model/TimeEntry';\nimport moment from 'moment';\nimport { Earnings } from '../components/Earnings';\nimport { Col, Row } from 'react-bootstrap';\nimport { Entries } from '../state/entries';\n\nexport interface ITimeEntryRowProps {\n\tdate: Date;\n\tday: Entries;\n\ttimeEntry: TimeEntry;\n\tonChange: (e: HTMLFormElement) => void;\n\tmakeEditable: (yesOrNo: boolean) => void;\n\tremove: () => void;\n}\n\nexport class TimeEntryRow extends React.Component<ITimeEntryRowProps> {\n\t// static contextType = GlobalContext;\n\t// @ts-ignore\n\t// context: AppState;\n\tcontext: undefined;\n\n\tget startValue() {\n\t\tif (this.props.timeEntry.start) {\n\t\t\treturn this.props.timeEntry.start;\n\t\t}\n\t\treturn moment().format('HH:mm');\n\t}\n\n\tget endValue() {\n\t\tif (this.props.timeEntry.end) {\n\t\t\treturn this.props.timeEntry.end;\n\t\t}\n\t\treturn '';\n\t}\n\n\tget duration() {\n\t\tconst dur = this.props.timeEntry.duration;\n\t\treturn (\n\t\t\tdur.hours().toString().padStart(2, '0') +\n\t\t\t':' +\n\t\t\tdur.minutes().toString().padStart(2, '0')\n\t\t);\n\t}\n\n\tget earnings() {\n\t\tconst hours = this.props.timeEntry.duration.asHours();\n\t\t// TODO: rate\n\t\treturn <Earnings hours={hours} rate={50} />;\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<Row>\n\t\t\t\t\t<Col onClick={() => this.props.makeEditable(true)}>\n\t\t\t\t\t\t{this.startValue}\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col\n\t\t\t\t\t\tclassName=\"text-right\"\n\t\t\t\t\t\tonClick={() => this.props.makeEditable(true)}\n\t\t\t\t\t>\n\t\t\t\t\t\t{this.endValue}\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col className=\"text-right\">{this.duration}</Col>\n\t\t\t\t\t<Col className=\"text-right\">{this.earnings}</Col>\n\t\t\t\t\t<Col onClick={() => this.props.makeEditable(true)}>\n\t\t\t\t\t\t{this.props.timeEntry.comment}\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\t\t\t</>\n\t\t);\n\t}\n}\n","import React, { FormEvent } from 'react';\nimport moment from 'moment';\nimport { ITimeEntryRowProps, TimeEntryRow } from './TimeEntryRow';\nimport { FaPlay, FaStop } from 'react-icons/fa';\nimport { Col, Form, Row } from 'react-bootstrap';\n\n// interface ITimeEntryRowProps {\n// \tdate: Date;\n// \ttimeEntry: TimeEntry;\n// \tonChange: (e: React.ChangeEvent) => void;\n// \tmakeEditable: (e: Event, yesOrNo: boolean) => void;\n// }\n\nexport class TimeEntryEdit extends TimeEntryRow {\n\ttimer: any;\n\tformRef: React.RefObject<HTMLFormElement>;\n\ttextInput: React.RefObject<HTMLInputElement>;\n\n\tconstructor(props: ITimeEntryRowProps) {\n\t\tsuper(props);\n\t\tconsole.log('TimeEntryEdit.constructor');\n\t\tthis.formRef = React.createRef();\n\t\tthis.textInput = React.createRef();\n\t\t// for removeEventListener\n\t\tthis.keydownHandler = this.keydownHandler.bind(this);\n\t}\n\n\tget endOutput() {\n\t\treturn moment().format('HH:mm:ss');\n\t}\n\n\tkeydownHandler(e: KeyboardEvent) {\n\t\t// console.log(e.key, e.ctrlKey, e.metaKey);\n\t\tif (e.key === 'Enter' && e.ctrlKey) {\n\t\t\te.preventDefault();\n\t\t\tthis.submit();\n\t\t}\n\t\tif (e.key === 'Backspace' && e.ctrlKey) {\n\t\t\te.preventDefault();\n\t\t\tconsole.log(e.key);\n\t\t\tthis.props.remove();\n\t\t}\n\t}\n\n\tcomponentDidMount(): void {\n\t\tconsole.log('addEventListener');\n\t\tdocument.addEventListener('keydown', this.keydownHandler);\n\t\tthis.textInput?.current?.focus();\n\t}\n\n\tcomponentWillUnmount(): void {\n\t\tconsole.log('removeEventListener');\n\t\tdocument.removeEventListener('keydown', this.keydownHandler);\n\t}\n\n\tsubmit(e?: FormEvent) {\n\t\te && e.preventDefault();\n\t\tconsole.log('formRef', this.formRef.current);\n\t\tthis.formRef.current && this.props.onChange(this.formRef.current);\n\t\tthis.props.makeEditable(false);\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<Form ref={this.formRef} onSubmit={this.submit.bind(this)}>\n\t\t\t\t<Row className=\"timeEntryRow\">\n\t\t\t\t\t<Col>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"time\"\n\t\t\t\t\t\t\tname=\"start\"\n\t\t\t\t\t\t\tform=\"form1\"\n\t\t\t\t\t\t\tdefaultValue={this.startValue}\n\t\t\t\t\t\t\t// onChange={this.props.onChange}\n\t\t\t\t\t\t\tclassName=\"form-control\"\n\t\t\t\t\t\t\tref={this.textInput}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col>\n\t\t\t\t\t\t<div className=\"d-flex\">\n\t\t\t\t\t\t\t{this.endValue ? (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\ttype=\"time\"\n\t\t\t\t\t\t\t\t\t\tname=\"end\"\n\t\t\t\t\t\t\t\t\t\tform=\"form1\"\n\t\t\t\t\t\t\t\t\t\tdefaultValue={this.endValue}\n\t\t\t\t\t\t\t\t\t\t// onChange={this.props.onChange}\n\t\t\t\t\t\t\t\t\t\tclassName=\"form-control\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\thref=\"/play\"\n\t\t\t\t\t\t\t\t\t\tclassName=\"pl-3\"\n\t\t\t\t\t\t\t\t\t\tonClick={this.play.bind(this)}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<FaPlay />\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<output>{this.endOutput}</output>\n\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\thref=\"/stop\"\n\t\t\t\t\t\t\t\t\t\tclassName=\"pl-3\"\n\t\t\t\t\t\t\t\t\t\tonClick={this.stop.bind(this)}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<FaStop />\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col className=\"text-right\">\n\t\t\t\t\t\t<output>{this.duration}</output>\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col className=\"text-right\">\n\t\t\t\t\t\t<output>{this.earnings}</output>\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col>\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tname=\"comment\"\n\t\t\t\t\t\t\tplaceholder=\"comment\"\n\t\t\t\t\t\t\tclassName=\"form-control\"\n\t\t\t\t\t\t\tform=\"form1\"\n\t\t\t\t\t\t\t// onChange={this.props.onChange}\n\t\t\t\t\t\t\tdefaultValue={this.props.timeEntry.comment}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Col>\n\t\t\t\t</Row>\n\t\t\t</Form>\n\t\t);\n\t}\n\n\tplay(e: React.MouseEvent) {\n\t\te.preventDefault();\n\t\tthis.props.timeEntry.end = undefined;\n\t\t// const dayStorage = this.context.getDay(this.props.date);\n\t\tconst dayStorage = this.props.day;\n\t\tdayStorage.updateOne(this.props.timeEntry);\n\t\tthis.startTimer();\n\t}\n\n\tstartTimer() {\n\t\tthis.timer = setInterval(() => this.forceUpdate(), 1000);\n\t}\n\n\tstop(e: React.MouseEvent) {\n\t\te.preventDefault();\n\t\tthis.props.timeEntry.end = moment().format('HH:mm');\n\t\t// const dayStorage = this.context.getDay(this.props.date);\n\t\tconst dayStorage = this.props.day;\n\t\tdayStorage.updateOne(this.props.timeEntry);\n\t\tthis.stopTimer();\n\t\tthis.props.makeEditable(false);\n\t}\n\n\tstopTimer() {\n\t\tthis.timer && clearInterval(this.timer);\n\t}\n}\n","import React from 'react';\nimport { FaPlus } from 'react-icons/fa';\nimport { DayProvider } from '../state/DayProvider';\nimport { TimeEntry } from '../model/TimeEntry';\nimport { TimeEntryRow } from './TimeEntryRow';\nimport moment from 'moment';\nimport { TimeEntryEdit } from './TimeEntryEdit';\nimport { Earnings } from '../components/Earnings';\nimport { Col, Container, Row } from 'react-bootstrap';\nimport { Entries } from '../state/entries';\nimport { inputElementsToMap } from '../functions';\n\ninterface Props {\n\tdate: Date;\n\tday: Entries;\n\tappState: DayProvider; // for subscribe/unsubscribe\n}\n\ninterface IDayTableState {\n\tentries: TimeEntry[];\n\teditable: boolean[];\n}\n\nexport class DayTable extends React.Component<Props, IDayTableState> {\n\t// static contextType = GlobalContext;\n\t// @ts-ignore\n\t// context: AppState;\n\tcontext: undefined;\n\n\tstate = {\n\t\tentries: [],\n\t\teditable: [],\n\t};\n\n\tconstructor(props: Props) {\n\t\tsuper(props);\n\t\tthis.keydownHandler = this.keydownHandler.bind(this);\n\t}\n\n\tcomponentDidMount(): void {\n\t\tthis.fetch();\n\t\tdocument.addEventListener('keydown', this.keydownHandler);\n\t}\n\n\tcomponentWillUnmount(): void {\n\t\tdocument.removeEventListener('keydown', this.keydownHandler);\n\t}\n\n\tcomponentDidUpdate(prevProps: any) {\n\t\tif (prevProps.date !== this.props.date) {\n\t\t\tthis.fetch();\n\t\t}\n\t}\n\n\tfetch() {\n\t\t// const dayState = this.context.getDay(this.props.date);\n\t\tconst dayState = this.props.day;\n\t\tconst entries = dayState.state.entries;\n\t\t// console.log('componentDidMount', entries);\n\t\tthis.setState(\n\t\t\t{\n\t\t\t\tentries,\n\t\t\t},\n\t\t\t() => {\n\t\t\t\tif (this.state.entries.length === 0) {\n\t\t\t\t\t// this.addRow(null);\n\t\t\t\t}\n\t\t\t},\n\t\t);\n\t}\n\n\tkeydownHandler(e: KeyboardEvent) {\n\t\t// console.log(e.key, e.ctrlKey, e.metaKey);\n\t\tif (e.key === 'Insert') {\n\t\t\t// @ts-ignore\n\t\t\tthis.addRow((e as unknown) as Event);\n\t\t}\n\t\tif (e.key === 'Escape') {\n\t\t\t// console.log(e.key);\n\t\t\tthis.setState({\n\t\t\t\teditable: [],\n\t\t\t});\n\t\t}\n\t}\n\n\trender() {\n\t\t// console.log('DayTable.render', this.props.date);\n\t\treturn (\n\t\t\t<Container fluid={true} id=\"timeTable\" className=\"py-3\">\n\t\t\t\t<Row\n\t\t\t\t\tclassName=\"border-top\"\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tcolor: '#495057',\n\t\t\t\t\t\tbackgroundColor: '#e9ecef',\n\t\t\t\t\t\tborderColor: '#dee2e6',\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<Col>Start Time</Col>\n\t\t\t\t\t<Col className=\"text-right\">End Time</Col>\n\t\t\t\t\t<Col className=\"text-right\">Duration</Col>\n\t\t\t\t\t<Col className=\"text-right\">Earnings</Col>\n\t\t\t\t\t<Col>Comment</Col>\n\t\t\t\t</Row>\n\t\t\t\t{this.state.entries.map((te: TimeEntry, index: number) =>\n\t\t\t\t\tte.end && !this.state.editable[index] ? (\n\t\t\t\t\t\t<TimeEntryRow\n\t\t\t\t\t\t\tdate={this.props.date}\n\t\t\t\t\t\t\ttimeEntry={te}\n\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\tday={this.props.day}\n\t\t\t\t\t\t\tonChange={(form) => this.onChange(form, index)}\n\t\t\t\t\t\t\tmakeEditable={(yesNo) =>\n\t\t\t\t\t\t\t\tthis.makeEditable(index, yesNo)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tremove={() => {}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<TimeEntryEdit\n\t\t\t\t\t\t\tdate={this.props.date}\n\t\t\t\t\t\t\ttimeEntry={te}\n\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\tday={this.props.day}\n\t\t\t\t\t\t\tonChange={(form) => this.onChange(form, index)}\n\t\t\t\t\t\t\tmakeEditable={(yesNo) =>\n\t\t\t\t\t\t\t\tthis.makeEditable(index, yesNo)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tremove={this.remove.bind(this, index, te)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t),\n\t\t\t\t)}\n\t\t\t\t<Row\n\t\t\t\t\tclassName=\"tfoot-light\"\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tcolor: '#495057',\n\t\t\t\t\t\tbackgroundColor: '#e9ecef',\n\t\t\t\t\t\tborderColor: '#dee2e6',\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<Col>\n\t\t\t\t\t\t<a href=\"/addRow\" onClick={this.addRow.bind(this)}>\n\t\t\t\t\t\t\t<FaPlus />\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</Col>\n\t\t\t\t\t{/*<Col>*/}\n\t\t\t\t\t{/*{moment(this.props.date).isSame(moment(), \"day\") ? (*/}\n\t\t\t\t\t{/*  <a href=\"/addPlay\" onClick={this.addPlay.bind(this)}>*/}\n\t\t\t\t\t{/*    <FaPlay />*/}\n\t\t\t\t\t{/*  </a>*/}\n\t\t\t\t\t{/*) : null}*/}\n\t\t\t\t\t{/*</Col>*/}\n\t\t\t\t\t<Col className=\"text-right\">\n\t\t\t\t\t\t&Sigma; {this.props.day.sumTimeString}\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col className=\"text-right\">\n\t\t\t\t\t\t{this.props.day.sumHoursString} h\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col className=\"text-right\">\n\t\t\t\t\t\t<Earnings hours={this.props.day.sumHours} rate={50} />\n\t\t\t\t\t</Col>\n\t\t\t\t\t<Col />\n\t\t\t\t</Row>\n\t\t\t</Container>\n\t\t);\n\t}\n\n\tonChange(form: HTMLFormElement, index: number) {\n\t\tconsole.log('onChange', index, form);\n\t\tif (form === null) {\n\t\t\treturn;\n\t\t}\n\t\t// @ts-ignore\n\t\tconst eElements = form.querySelectorAll(\n\t\t\t'input, textarea',\n\t\t) as NodeListOf<HTMLInputElement>;\n\t\tconst values = inputElementsToMap(eElements);\n\t\t// console.log(index, values);\n\t\tconst entries: TimeEntry[] = this.state.entries;\n\t\tentries[index] = new TimeEntry(values);\n\t\tthis.setState({\n\t\t\tentries,\n\t\t});\n\t\t// const dayState = this.context.getDay(this.props.date);\n\t\tconst dayState = this.props.day;\n\t\tdayState.updateEntries(this.state.entries);\n\t}\n\n\taddRow(e: React.MouseEvent | null) {\n\t\tif (e) {\n\t\t\te.preventDefault();\n\t\t}\n\t\tconst entries: TimeEntry[] = this.state.entries;\n\n\t\tif (entries.length > 0) {\n\t\t\tconst lastEntry = entries[entries.length - 1];\n\t\t\tlastEntry.finish();\n\t\t}\n\t\tentries.push(\n\t\t\tnew TimeEntry({\n\t\t\t\tstart: moment().subtract(1, 'hour').format('HH:mm'),\n\t\t\t\tend: moment().format('HH:mm'),\n\t\t\t}),\n\t\t); // add current entry to the list\n\n\t\tconst index = entries.length - 1;\n\t\tconst editable = this.state.editable;\n\t\t// @ts-ignore\n\t\teditable[index] = true;\n\n\t\tthis.setState(\n\t\t\t{\n\t\t\t\tentries,\n\t\t\t\teditable,\n\t\t\t},\n\t\t\t() => {\n\t\t\t\t// const dayState = this.context.getDay(this.props.date);\n\t\t\t\tconst dayState = this.props.day;\n\t\t\t\tdayState.updateEntries(entries);\n\t\t\t},\n\t\t);\n\t}\n\n\taddPlay(e: React.MouseEvent | null) {\n\t\tif (e) {\n\t\t\te.preventDefault();\n\t\t}\n\t\tconst entries: TimeEntry[] = this.state.entries;\n\n\t\tif (entries.length > 0) {\n\t\t\tconst lastEntry = entries[entries.length - 1];\n\t\t\tlastEntry.finish();\n\t\t}\n\t\tentries.push(\n\t\t\tnew TimeEntry({\n\t\t\t\tstart: moment().format('HH:mm'),\n\t\t\t}),\n\t\t); // add current entry to the list\n\t\tthis.setState(\n\t\t\t{\n\t\t\t\tentries,\n\t\t\t},\n\t\t\t() => {\n\t\t\t\t// this.context.getDay(this.props.date).updateEntries(entries);\n\t\t\t\t// const dayState = this.context.getDay(this.props.date);\n\t\t\t\tconst dayState = this.props.day;\n\t\t\t\tdayState.updateEntries(entries);\n\t\t\t},\n\t\t);\n\t}\n\n\tmakeEditable(index: number, yesNo: boolean) {\n\t\tconst editable = this.state.editable;\n\t\t// @ts-ignore\n\t\teditable[index] = yesNo;\n\t\tthis.setState({\n\t\t\teditable,\n\t\t});\n\t}\n\n\tremove(index: number, te: TimeEntry) {\n\t\t// this.context.getCurrentEntries().remove(index);\n\t\t// const dayState = this.context.getDay(this.props.date);\n\t\tconsole.log('removing', index);\n\t\tconst dayState = this.props.day;\n\t\tdayState.remove(index);\n\t}\n}\n","import React, { useState, useEffect } from 'react';\n\ntype Props = {\n\tchildren: React.ReactNode;\n\twaitBeforeShow?: number;\n};\n\n// https://stackoverflow.com/questions/30803440/delayed-rendering-of-react-components\nconst Delayed = ({ children, waitBeforeShow = 500 }: Props): JSX.Element => {\n\tconst [isShown, setIsShown] = useState(false);\n\n\tuseEffect(() => {\n\t\tsetTimeout(() => {\n\t\t\tsetIsShown(true);\n\t\t}, waitBeforeShow);\n\t}, [waitBeforeShow]);\n\n\treturn (isShown ? children : null) as JSX.Element;\n};\n\nexport default Delayed;\n","import { Moment } from 'moment';\nimport React from 'react';\nimport { DayProvider } from '../state/DayProvider';\nimport { Entries } from '../state/entries';\n\nfunction ExtractWeekData1({\n\tmonday,\n\tdayProvider,\n\tchildren,\n}: {\n\tmonday: Moment;\n\tdayProvider: DayProvider;\n\tchildren: (dateRange: Entries[]) => JSX.Element;\n}) {\n\tfunction dateRange() {\n\t\tconst dateRange = [];\n\t\tfor (let i = 0; i < 7; i++) {\n\t\t\tconst dayState = dayProvider.getDay(\n\t\t\t\tmonday.clone().add(i, 'days').toDate(),\n\t\t\t);\n\t\t\tdateRange.push(dayState);\n\t\t}\n\t\treturn dateRange;\n\t}\n\n\treturn children(dateRange());\n}\n\nexport const ExtractWeekData = React.memo(\n\tExtractWeekData1,\n\t(a, b) => a.monday.toISOString() === b.monday.toISOString(),\n);\n","import React from 'react';\nimport moment from 'moment';\nimport { Earnings } from '../components/Earnings';\nimport { Entries } from '../state/entries';\n// @ts-ignore\n// import debounceRender from 'react-debounce-render';\n\nconst findHashtags = require('find-hashtags');\n\ninterface Props {\n\tdate: Date;\n\tdateRange: Entries[];\n}\n\nexport class WeekTotalComponent extends React.PureComponent<Props, {}> {\n\t// static contextType = GlobalContext;\n\t// @ts-ignore\n\t// context: AppState;\n\tcontext: undefined;\n\n\tget duration() {\n\t\tlet sum = moment.duration(0);\n\t\tfor (const dayState of this.props.dateRange) {\n\t\t\tsum.add(dayState.sumTime);\n\t\t}\n\t\treturn sum;\n\t}\n\n\tget sumHours() {\n\t\treturn this.duration.asHours().toFixed(2);\n\t}\n\n\tget sumTime() {\n\t\tlet hh = this.duration.get('hours');\n\t\tlet mm = this.duration.get('minutes');\n\t\treturn (\n\t\t\thh.toString().padStart(2, '0') +\n\t\t\t':' +\n\t\t\tmm.toString().padStart(2, '0')\n\t\t);\n\t}\n\n\tget sumMoney() {\n\t\tconst hours = this.duration.asHours();\n\t\t// TODO: rate\n\t\treturn <Earnings hours={hours} rate={50} />;\n\t}\n\n\tget hashtags() {\n\t\tconst tagTimes: { [key: string]: number } = {};\n\t\tfor (const dayState of this.props.dateRange) {\n\t\t\tfor (const te of dayState.state.entries) {\n\t\t\t\tconst tags = findHashtags(te.comment);\n\t\t\t\tfor (const tag of tags) {\n\t\t\t\t\tif (!(tag in tagTimes)) {\n\t\t\t\t\t\ttagTimes[tag] = 0;\n\t\t\t\t\t}\n\t\t\t\t\ttagTimes[tag] += te.duration.asHours();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tconst sorted = Object.entries(tagTimes).sort(\n\t\t\t(a: [string, number], b: [string, number]) => {\n\t\t\t\treturn (b[1] as number) - a[1]; // value\n\t\t\t},\n\t\t);\n\t\treturn Object.fromEntries(sorted);\n\t}\n\n\tget title() {\n\t\treturn (\n\t\t\t<h5 style={{ paddingTop: 0 }}>\n\t\t\t\tWeek #{moment(this.props.date).isoWeek()} total\n\t\t\t</h5>\n\t\t);\n\t}\n\n\trender() {\n\t\tconst hashtags = this.hashtags;\n\t\treturn (\n\t\t\t<div className=\"card w-100\">\n\t\t\t\t<div className=\"jumbotron p-3\">\n\t\t\t\t\t<h1 className=\"display-4 text-center\">{this.sumHours}h</h1>\n\t\t\t\t\t<h3 className=\"lead left\">{this.sumTime}</h3>\n\t\t\t\t\t<h3 className=\"lead text-right\">{this.sumMoney}</h3>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"card-body\">{this.title}</div>\n\t\t\t\t<ul className=\"list-group list-group-flush\">\n\t\t\t\t\t{Object.keys(hashtags).map((tag) => (\n\t\t\t\t\t\t<li\n\t\t\t\t\t\t\tclassName=\"list-group-item d-flex justify-content-between\"\n\t\t\t\t\t\t\tkey={tag}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{tag}\n\t\t\t\t\t\t\t<span className=\"badge badge-primary badge-pill\">\n\t\t\t\t\t\t\t\t{hashtags[tag].toFixed(2)}h\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t))}\n\t\t\t\t</ul>\n\t\t\t\t<div className=\"text-muted\">{Math.random()}</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\n// export const WeekTotal = debounceRender(WeekTotalComponent);\nexport const WeekTotal = WeekTotalComponent;\n","import React from 'react';\nimport moment from 'moment';\nimport { WeekTotalComponent } from './WeekTotal';\n// @ts-ignore\n// import debounceRender from 'react-debounce-render';\n\nexport class MonthTotalComponent extends WeekTotalComponent {\n\tget title() {\n\t\tlet month = moment(this.props.date);\n\t\treturn <h5>Month {month.format('YYYY-MM')} total</h5>;\n\t}\n}\n\n// export const MonthTotal = debounceRender(MonthTotalComponent);\nexport const MonthTotal = React.memo(MonthTotalComponent);\n","import { useCallback, useEffect, useState } from 'react';\nimport { TimeEntry } from '../model/TimeEntry';\nimport { Entries } from '../state/entries';\n\nexport default function ClipboardHandler(props: { day: Entries }) {\n\tconst [clipboard, setClipboard] = useState([] as TimeEntry[]);\n\n\tconst escFunction = useCallback(\n\t\t(event: KeyboardEvent) => {\n\t\t\tif (event.key.toLowerCase() === 'c' && event.ctrlKey) {\n\t\t\t\tconsole.log('Ctrl-C');\n\t\t\t\tlet timeEntries = props.day.state.entries;\n\t\t\t\tsetClipboard(timeEntries.slice());\n\t\t\t\tconsole.log(timeEntries, clipboard);\n\t\t\t} else if (event.key.toLowerCase() === 'v' && event.ctrlKey) {\n\t\t\t\tconsole.log('Ctrl-V');\n\t\t\t\tif (!clipboard) {\n\t\t\t\t\tconsole.log('clipboard is empty');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (props.day.state.entries.length) {\n\t\t\t\t\t// throw new Error(\"Overwriting is dangerous\");\n\t\t\t\t\tconsole.warn('Overwriting is dangerous');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconsole.log(clipboard);\n\t\t\t\tprops.day.updateEntries(clipboard.slice());\n\t\t\t} else if (event.key && event.key !== 'Control') {\n\t\t\t\t// console.log(\n\t\t\t\t//   event.ctrlKey ? \"Ctrl\" : \"\",\n\t\t\t\t//   event.altKey ? \"Alt\" : \"\",\n\t\t\t\t//   event.shiftKey ? \"Shift\" : \"\",\n\t\t\t\t//   event.key\n\t\t\t\t// );\n\t\t\t}\n\t\t},\n\t\t[props.day, clipboard],\n\t);\n\n\tuseEffect(() => {\n\t\tdocument.addEventListener('keydown', escFunction, false);\n\n\t\treturn () => {\n\t\t\tdocument.removeEventListener('keydown', escFunction, false);\n\t\t};\n\t}, [props.day, clipboard, escFunction]);\n\n\treturn <></>;\n}\n","import { Entries } from '../state/entries';\nimport { DayProvider } from '../state/DayProvider';\nimport { DayChart } from '../components/DayChart';\nimport { DayTable } from '../table/DayTable';\nimport Delayed from '../components/delayed';\nimport { ExtractWeekData } from '../stats/extract-week-data';\nimport moment from 'moment';\nimport { WeekTotal } from '../stats/WeekTotal';\nimport { MonthTotal } from '../stats/MonthTotal';\nimport React from 'react';\nimport ClipboardHandler from '../table/clipboard-handler';\n\nexport default function MainPage(props: {\n\tdate: Date;\n\tsetDate: (date: Date) => void;\n\tdayData: Entries;\n\tappState: DayProvider;\n}) {\n\treturn (\n\t\t<>\n\t\t\t<DayChart workEntries={props.dayData.state.entries} />\n\t\t\t<DayTable\n\t\t\t\tdate={props.date}\n\t\t\t\tday={props.dayData}\n\t\t\t\tappState={props.appState}\n\t\t\t/>\n\t\t\t<div\n\t\t\t\tclassName=\"d-flex justify-content-between\"\n\t\t\t\tstyle={{\n\t\t\t\t\tgap: 12,\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{/*<SlowComponentSameProps*/}\n\t\t\t\t{/*\tprop={moment().hour() + ':' + moment().minute()}*/}\n\t\t\t\t{/*/>*/}\n\t\t\t\t<Delayed>\n\t\t\t\t\t<ExtractWeekData\n\t\t\t\t\t\tmonday={moment(props.date).startOf('week')}\n\t\t\t\t\t\tdayProvider={props.appState}\n\t\t\t\t\t>\n\t\t\t\t\t\t{(dateRange) => (\n\t\t\t\t\t\t\t<WeekTotal\n\t\t\t\t\t\t\t\tdate={props.date}\n\t\t\t\t\t\t\t\tdateRange={dateRange}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</ExtractWeekData>\n\t\t\t\t\t<ExtractWeekData\n\t\t\t\t\t\tmonday={moment(props.date).startOf('month')}\n\t\t\t\t\t\tdayProvider={props.appState}\n\t\t\t\t\t>\n\t\t\t\t\t\t{(dateRange) => (\n\t\t\t\t\t\t\t<MonthTotal\n\t\t\t\t\t\t\t\tdate={props.date}\n\t\t\t\t\t\t\t\tdateRange={dateRange}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</ExtractWeekData>\n\t\t\t\t</Delayed>\n\t\t\t</div>\n\t\t\t<ClipboardHandler day={props.dayData} />\n\t\t</>\n\t);\n}\n","import React from 'react';\nimport moment from 'moment';\nimport Table from 'react-bootstrap/Table';\nimport { Entries } from '../state/entries';\nimport { humanTime } from '../functions';\n\ninterface IReportProps {\n\tdate: Date;\n\tgetDay: (date: Date) => Entries;\n}\n\ninterface IReportState {}\n\nexport class SAP extends React.Component<IReportProps, IReportState> {\n\t// static contextType = GlobalContext;\n\t// @ts-ignore\n\t// context: AppState;\n\tcontext: undefined;\n\n\trender() {\n\t\tlet startOfWeek = moment(this.props.date).startOf('isoWeek'); // start with monday\n\t\tconst days = Array.from(new Array(7), (x, i) =>\n\t\t\tmoment(startOfWeek).add(i, 'days'),\n\t\t);\n\t\t// console.log(days.map((m) => m.format('YYYY-MM-DD')));\n\n\t\tconst dataMap: Record<string, number> = {};\n\t\tfor (let date of days) {\n\t\t\tconst dayRepo: Entries = this.props.getDay(date.toDate());\n\t\t\tconst hours = dayRepo.sumHours ? dayRepo.sumHours + 1 : 0;\n\t\t\tdataMap[date.format('YYYY-MM-DD')] = hours;\n\t\t}\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<h3>#{startOfWeek.week().toString().padStart(2, '0')}</h3>\n\t\t\t\t<Table as=\"table\">\n\t\t\t\t\t{Object.entries(dataMap).map(([date, sumHours]) => (\n\t\t\t\t\t\t<col\n\t\t\t\t\t\t\tkey={date}\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\tbackground:\n\t\t\t\t\t\t\t\t\tmoment(this.props.date).format(\n\t\t\t\t\t\t\t\t\t\t'YYYY-MM-DD',\n\t\t\t\t\t\t\t\t\t) === date\n\t\t\t\t\t\t\t\t\t\t? '#abc'\n\t\t\t\t\t\t\t\t\t\t: [7, 6].includes(\n\t\t\t\t\t\t\t\t\t\t\t\tmoment(date).isoWeekday(),\n\t\t\t\t\t\t\t\t\t\t  )\n\t\t\t\t\t\t\t\t\t\t? '#eee'\n\t\t\t\t\t\t\t\t\t\t: 'inherit',\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t))}\n\t\t\t\t\t<thead>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t{Object.entries(dataMap).map(([date, sumHours]) => (\n\t\t\t\t\t\t\t\t<td key={date}>{moment(date).format('ddd')}</td>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t{Object.entries(dataMap).map(([date, sumHours]) => (\n\t\t\t\t\t\t\t\t<td key={date}>{date}</td>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</thead>\n\t\t\t\t\t<tbody>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t{Object.entries(dataMap).map(([date, sumHours]) => {\n\t\t\t\t\t\t\t\tif (!sumHours) {\n\t\t\t\t\t\t\t\t\treturn <td />;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tconst startTime = 9; // 09:00\n\t\t\t\t\t\t\t\tconst beforeLunch =\n\t\t\t\t\t\t\t\t\tsumHours > 6\n\t\t\t\t\t\t\t\t\t\t? '13:00'\n\t\t\t\t\t\t\t\t\t\t: humanTime(startTime + sumHours);\n\t\t\t\t\t\t\t\tconst afterLunch1 =\n\t\t\t\t\t\t\t\t\tsumHours > 6 ? humanTime(14) : null;\n\t\t\t\t\t\t\t\tconst afterLunch2 =\n\t\t\t\t\t\t\t\t\tsumHours > 6\n\t\t\t\t\t\t\t\t\t\t? humanTime(14 + sumHours - 4)\n\t\t\t\t\t\t\t\t\t\t: null;\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<td key={date}>\n\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t{humanTime(startTime)} -{' '}\n\t\t\t\t\t\t\t\t\t\t\t{beforeLunch}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t{afterLunch1} - {afterLunch2}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</tbody>\n\t\t\t\t\t<tfoot>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t{Object.entries(dataMap).map(([date, sumHours]) => (\n\t\t\t\t\t\t\t\t<td className=\"\">\n\t\t\t\t\t\t\t\t\t&Sigma;{' '}\n\t\t\t\t\t\t\t\t\t<span title={sumHours.toString()}>\n\t\t\t\t\t\t\t\t\t\t{humanTime(sumHours)}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</tfoot>\n\t\t\t\t</Table>\n\t\t\t</>\n\t\t);\n\t}\n}\n","import { Route, Switch } from 'react-router-dom';\nimport { Report } from './page/Report';\nimport React from 'react';\nimport { SetDate } from './state/DateState';\nimport { DayProvider } from './state/DayProvider';\nimport { Entries } from './state/entries';\nimport MainPage from './page/main-page';\nimport { SAP } from './page/sap';\n\ninterface Props {\n\tdate: Date;\n\tsetDate: SetDate;\n\tdayData: Entries;\n\tdayProvider: DayProvider;\n}\n\nexport default function RouterSwitch(props: Props) {\n\tconst date = props.date;\n\tconst setDate = props.setDate;\n\treturn (\n\t\t<Switch>\n\t\t\t<Route exact path=\"/\">\n\t\t\t\t<MainPage\n\t\t\t\t\tdate={date}\n\t\t\t\t\tsetDate={setDate}\n\t\t\t\t\tdayData={props.dayData}\n\t\t\t\t\tappState={props.dayProvider}\n\t\t\t\t/>\n\t\t\t</Route>\n\t\t\t<Route path=\"/report\">\n\t\t\t\t<Report\n\t\t\t\t\tdate={date}\n\t\t\t\t\tgetDay={props.dayProvider.getDay.bind(props.dayProvider)}\n\t\t\t\t/>\n\t\t\t</Route>\n\t\t\t<Route path=\"/sap\">\n\t\t\t\t<SAP\n\t\t\t\t\tdate={date}\n\t\t\t\t\tgetDay={props.dayProvider.getDay.bind(props.dayProvider)}\n\t\t\t\t/>\n\t\t\t</Route>\n\t\t</Switch>\n\t);\n}\n","import { useCallback, useEffect } from 'react';\n\nexport default function KeyNav(props: {\n\tincDate: () => void;\n\tdecDate: () => void;\n}) {\n\tconst escFunction = useCallback(\n\t\t(event: KeyboardEvent) => {\n\t\t\tif (event.key === 'ArrowLeft' && event.ctrlKey) {\n\t\t\t\tprops.decDate();\n\t\t\t} else if (event.key === 'ArrowRight' && event.ctrlKey) {\n\t\t\t\tprops.incDate();\n\t\t\t} else if (event.key && event.key !== 'Control') {\n\t\t\t\t// console.log(\n\t\t\t\t//   event.ctrlKey ? \"Ctrl\" : \"\",\n\t\t\t\t//   event.altKey ? \"Alt\" : \"\",\n\t\t\t\t//   event.shiftKey ? \"Shift\" : \"\",\n\t\t\t\t//   event.key\n\t\t\t\t// );\n\t\t\t}\n\t\t},\n\t\t[props],\n\t);\n\n\tuseEffect(() => {\n\t\tdocument.addEventListener('keydown', escFunction, false);\n\n\t\treturn () => {\n\t\t\tdocument.removeEventListener('keydown', escFunction, false);\n\t\t};\n\t}, [props, escFunction]);\n\n\treturn <></>;\n}\n","import React from 'react';\nimport moment from 'moment';\nimport './DayTimeline.scss';\n\ninterface Props {\n\tdate: Date;\n\tsetDate: (date: Date) => void;\n}\n\nexport class DayTimeline extends React.Component<Props, {}> {\n\t// static contextType = GlobalContext;\n\t// @ts-ignore\n\t// context: AppState;\n\tcontext: undefined;\n\n\tmyInput: any;\n\n\tconstructor(props: any) {\n\t\tsuper(props);\n\t\tthis.myInput = React.createRef();\n\t\tthis.keydownHandler = this.keydownHandler.bind(this);\n\t\tthis.handleResize = this.handleResize.bind(this);\n\t}\n\n\tget range() {\n\t\tif (this.myInput.current) {\n\t\t\treturn Math.round(this.myInput.current.offsetWidth / 32 / 2) - 1;\n\t\t}\n\t\treturn 10;\n\t}\n\n\tkeydownHandler(e: KeyboardEvent) {\n\t\t//console.log(e.key, e.ctrlKey, e.metaKey);\n\t\tconst ctrl = (e.ctrlKey || e.metaKey) && e.shiftKey;\n\t\tif (ctrl && e.key === 'ArrowLeft') {\n\t\t\t// @ts-ignore\n\t\t\tthis.dayClick(\n\t\t\t\t(e as unknown) as React.MouseEvent,\n\t\t\t\tmoment(this.props.date).subtract('1', 'day'),\n\t\t\t);\n\t\t}\n\t\tif (ctrl && e.key === 'ArrowRight') {\n\t\t\t// @ts-ignore\n\t\t\tthis.dayClick(\n\t\t\t\t(e as unknown) as React.MouseEvent,\n\t\t\t\tmoment(this.props.date).add('1', 'day'),\n\t\t\t);\n\t\t}\n\t}\n\n\tcomponentDidMount(): void {\n\t\tdocument.addEventListener('keydown', this.keydownHandler);\n\t\tconsole.log('width', this.myInput.current.offsetWidth, 'rerender');\n\t\tif (this.myInput.current) {\n\t\t\twindow.addEventListener('resize', this.handleResize);\n\t\t}\n\n\t\tthis.forceUpdate(); // width calculated - re-render with dates\n\t}\n\n\tcomponentWillUnmount(): void {\n\t\tdocument.removeEventListener('keydown', this.keydownHandler);\n\t\twindow.removeEventListener('resize', this.handleResize);\n\t}\n\n\thandleResize() {\n\t\t// console.log('resize');\n\t\tthis.forceUpdate();\n\t}\n\n\trender() {\n\t\tconst days = [];\n\t\tconst today = moment(this.props.date);\n\t\tfor (let i = -this.range; i <= this.range; i++) {\n\t\t\tdays.push(today.clone().add(i, 'days'));\n\t\t}\n\n\t\tif (!this.myInput.current) {\n\t\t\treturn (\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"d-flex justify-content-center mb-3\"\n\t\t\t\t\tref={this.myInput}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName=\"d-flex justify-content-center mb-3\"\n\t\t\t\tref={this.myInput}\n\t\t\t>\n\t\t\t\t{days.map((day) => {\n\t\t\t\t\tconst isWeekend = [6, 7].includes(day.isoWeekday())\n\t\t\t\t\t\t? 'weekend'\n\t\t\t\t\t\t: '';\n\t\t\t\t\tconst isToday = day.isSame(this.props.date, 'day')\n\t\t\t\t\t\t? 'today'\n\t\t\t\t\t\t: '';\n\t\t\t\t\tlet dayBox = (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\t\t'dayBox border text-center align-baseline ' +\n\t\t\t\t\t\t\t\t[isWeekend, isToday].join(' ')\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tkey={day.toISOString()}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{day.format('DD')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t);\n\t\t\t\t\tif (day.isSame(this.props.date, 'day')) {\n\t\t\t\t\t\treturn dayBox;\n\t\t\t\t\t}\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<a\n\t\t\t\t\t\t\thref={'/day/' + day.format('YYYY-MM-DD')}\n\t\t\t\t\t\t\tonClick={(e) => this.dayClick(e, day)}\n\t\t\t\t\t\t\tstyle={{ textDecoration: 'none' }}\n\t\t\t\t\t\t\tkey={day.toISOString()}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{dayBox}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t);\n\t\t\t\t})}\n\t\t\t</div>\n\t\t);\n\t}\n\n\tdayClick(e: React.MouseEvent, date: moment.Moment) {\n\t\te.preventDefault();\n\t\tthis.props.setDate(date.toDate());\n\t}\n}\n","import { DateState, SetDate } from '../state/DateState';\nimport { Entries } from '../state/entries';\nimport { DayProvider } from '../state/DayProvider';\nimport { Header } from '../components/Header';\nimport moment from 'moment';\nimport RouterSwitch from '../router-switch';\nimport KeyNav from '../components/key-nav';\nimport { Col, Row } from 'react-bootstrap';\nimport React from 'react';\nimport { DayTimeline } from '../components/DayTimeline';\n\nexport default function Layout(props: {\n\tdate: Date;\n\tsetDate: SetDate;\n\tdayData: Entries;\n\tdayProvider: DayProvider;\n\tdateState: DateState;\n}) {\n\treturn (\n\t\t<>\n\t\t\t<Header\n\t\t\t\tdate={moment(props.date)}\n\t\t\t\tday={props.dayData}\n\t\t\t\tsetDate={props.setDate}\n\t\t\t/>\n\t\t\t<main role=\"main\" className=\"container-fluid\">\n\t\t\t\t<div className=\"h-100\">\n\t\t\t\t\t<DayTimeline date={props.date} setDate={props.setDate} />\n\t\t\t\t\t<RouterSwitch\n\t\t\t\t\t\tdate={props.date}\n\t\t\t\t\t\tsetDate={props.setDate}\n\t\t\t\t\t\tdayData={props.dayData}\n\t\t\t\t\t\tdayProvider={props.dayProvider}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</main>\n\t\t\t<KeyNav\n\t\t\t\tincDate={props.dateState.incDate.bind(props.dateState)}\n\t\t\t\tdecDate={props.dateState.decDate.bind(props.dateState)}\n\t\t\t/>\n\t\t\t<footer className=\"container-fluid mt-3 py-2 border-top\">\n\t\t\t\t<div className=\"inner\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t&copy; 2021{' '}\n\t\t\t\t\t\t<a href=\"https://github.com/spidgorny/\">Slawa</a>\n\t\t\t\t\t</div>\n\t\t\t\t\t<Row>\n\t\t\t\t\t\t<Col>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<kbd>Ctrl-Left</kbd> - prev day\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<kbd>Ctrl-Right</kbd> - next day\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t<Col>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<kbd>Ins</kbd> - new line\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<kbd>Ctrl-Enter</kbd> - save edit\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<kbd>Ctrl-Backspace</kbd> - remove line\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t<Col>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<kbd>Ctrl-C</kbd> <kbd>Ctrl-V</kbd> - clipboard\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<kbd>Ctrl-S</kbd> - Download backup (json)\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t</Row>\n\t\t\t\t</div>\n\t\t\t</footer>\n\t\t</>\n\t);\n}\n","import { DayProvider } from '../state/DayProvider';\nimport { useCallback, useEffect } from 'react';\nimport moment from 'moment';\nimport { TimeEntry } from '../model/TimeEntry';\n\n/// https://stackoverflow.com/questions/19721439/download-json-object-as-a-file-from-browser\nfunction downloadObjectAsJson(exportObj: object, exportName: string) {\n\tconst dataStr =\n\t\t'data:text/json;charset=utf-8,' +\n\t\tencodeURIComponent(JSON.stringify(exportObj, null, 2));\n\tconst downloadAnchorNode = document.createElement('a');\n\tdownloadAnchorNode.setAttribute('href', dataStr);\n\tdownloadAnchorNode.setAttribute('download', exportName + '.json');\n\tdocument.body.appendChild(downloadAnchorNode); // required for firefox\n\tdownloadAnchorNode.click();\n\tdownloadAnchorNode.remove();\n}\n\nexport default function HandleSave(props: { dayProvider: DayProvider }) {\n\tconst onKeyDown = useCallback(\n\t\t(e: KeyboardEvent) => {\n\t\t\tif (e.key === 's' && e.ctrlKey) {\n\t\t\t\te.preventDefault();\n\t\t\t\t// console.log('Ctrl-S');\n\t\t\t\tconst year = 2020;\n\t\t\t\tconst yearDates: Date[] = [];\n\t\t\t\tlet start = moment().year(year).startOf('year');\n\t\t\t\t// console.log('start', start.toISOString());\n\t\t\t\tconst end = moment(start).add(1, 'year');\n\t\t\t\t// console.log('end', end.toISOString());\n\t\t\t\t// console.log('isBefore', start.isBefore(end));\n\t\t\t\twhile (start.isBefore(end)) {\n\t\t\t\t\tyearDates.push(start.toDate());\n\t\t\t\t\tstart = start.add(1, 'day');\n\t\t\t\t}\n\t\t\t\tconsole.log('yearDates', yearDates.length);\n\t\t\t\tconst data: Record<string, TimeEntry[]> = {};\n\t\t\t\tfor (const date of yearDates) {\n\t\t\t\t\tconst entries = props.dayProvider.getDay(date);\n\t\t\t\t\tif (entries.state.entries.length) {\n\t\t\t\t\t\tdata[\n\t\t\t\t\t\t\tmoment(date).format('YYYY-MM-DD')\n\t\t\t\t\t\t] = entries.state.entries.slice();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// console.log(data);\n\t\t\t\tdownloadObjectAsJson(\n\t\t\t\t\t{\n\t\t\t\t\t\tsignature: 'excel-time-tracking',\n\t\t\t\t\t\tyear: year,\n\t\t\t\t\t\tdata,\n\t\t\t\t\t},\n\t\t\t\t\t'excel-time-tracking-' + year,\n\t\t\t\t);\n\t\t\t}\n\t\t},\n\t\t[props.dayProvider],\n\t);\n\n\tuseEffect(() => {\n\t\twindow.addEventListener('keydown', onKeyDown);\n\t\treturn () => {\n\t\t\twindow.removeEventListener('keydown', onKeyDown);\n\t\t};\n\t}, [onKeyDown]);\n\n\treturn <></>;\n}\n","import React from 'react';\nimport './App.css';\nimport { Router } from 'react-router-dom';\nimport { createBrowserHistory } from 'history';\nimport { DayProvider } from './state/DayProvider';\nimport { DateState, SetDate } from './state/DateState';\nimport { Entries } from './state/entries';\nimport Layout from './page/layout';\nimport HandleSave from './table/handle-save';\n\nexport const history = createBrowserHistory();\nexport var DateContext = React.createContext(new Date());\n\nexport class App extends React.Component<any, any> {\n\t// static contextType = GlobalContext;\n\t// @ts-ignore\n\t// context: AppState;\n\tcontext: undefined;\n\n\tstate: {} = {};\n\n\trender() {\n\t\treturn (\n\t\t\t<DateState>\n\t\t\t\t{(date: Date, setDate: SetDate, dateState: DateState) => (\n\t\t\t\t\t<DayProvider date={date}>\n\t\t\t\t\t\t{(day: Entries, dayProvider: DayProvider) => (\n\t\t\t\t\t\t\t<Router history={history}>\n\t\t\t\t\t\t\t\t<Layout\n\t\t\t\t\t\t\t\t\tdate={date}\n\t\t\t\t\t\t\t\t\tdayData={day}\n\t\t\t\t\t\t\t\t\tsetDate={setDate}\n\t\t\t\t\t\t\t\t\tdayProvider={dayProvider}\n\t\t\t\t\t\t\t\t\tdateState={dateState}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<HandleSave dayProvider={dayProvider} />\n\t\t\t\t\t\t\t</Router>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</DayProvider>\n\t\t\t\t)}\n\t\t\t</DateState>\n\t\t);\n\t}\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}